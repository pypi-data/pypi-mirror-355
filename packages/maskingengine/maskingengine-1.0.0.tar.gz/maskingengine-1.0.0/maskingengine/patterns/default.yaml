# MaskingEngine Default Pattern Pack
# This file contains the default PII detection patterns that ship with MaskingEngine.
# Users can create custom pattern packs following this format.

name: "default"
description: "Default MaskingEngine PII patterns with universal and language-specific rules"
version: "1.0.0"

# Pattern definitions
patterns:
  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  # Universal Patterns (language-agnostic) - Core PII Types
  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  
  - name: EMAIL
    description: "Universal email address detection"
    tier: 1
    language: "universal"
    patterns:
      - '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'

  - name: CREDIT_CARD
    description: "Credit card numbers with Luhn validation (legacy pattern)"
    tier: 1
    language: "universal"
    patterns:
      - '\b(?:4\d{3}|5[1-5]\d{2}|3[47]\d{2}|6011)(?:[\s-]?\d{4}){3}\b|\b3[47]\d{2}[\s-]?\d{6}[\s-]?\d{5}\b'

  - name: CREDIT_CARD_NUMBER
    description: "Enhanced credit card detection (Visa, Mastercard, Amex, etc.)"
    tier: 1
    language: "universal"
    patterns:
      - '\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})\b'

  - name: IPV4
    description: "IPv4 address detection"
    tier: 1
    language: "universal"
    patterns:
      - '\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'

  - name: IPV6
    description: "IPv6 address detection"
    tier: 1
    language: "universal"
    patterns:
      - '\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\b'
      - '\b[0-9a-fA-F]{1,4}::[0-9a-fA-F]{1,4}\b'
      - '\b2001:db8::[a-fA-F0-9]{1,4}\b'
      - '\b[0-9a-fA-F]{4}:[0-9a-fA-F]{4}::[0-9a-fA-F]{1,4}\b'

  - name: PHONE
    description: "Comprehensive phone number detection (US and international)"
    tier: 1
    language: "universal"
    patterns:
      # US phone formats (simplified to avoid YAML escaping issues)
      - '\([2-9]\d{2}\)\s?\d{3}[-.\s]?\d{4}'
      - '[2-9]\d{2}[-.\s]\d{3}[-.\s]\d{4}'
      - '\+1[-.\s]?\d{3}[-.\s]?\d{3}[-.\s]?\d{4}'
      # International formats
      - '\+33\s?\d{1}\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}'
      - '\+(?:44|33|49|81|86|91|61|55|39|34|31|46|47|41|43|32|30)[\s.-]?\d{1,4}[\s.-]?\d{3,4}[\s.-]?\d{3,8}'

  - name: SSN
    description: "US Social Security Number"
    tier: 1
    language: "en"
    country: "US"
    patterns:
      - '\b\d{3}-\d{2}-\d{4}\b'

  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  # US-Specific Patterns
  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  - name: US_SSN
    description: "US Social Security Number"
    tier: 1
    language: "en"
    country: "US"
    patterns:
      - '\b\d{3}-\d{2}-\d{4}\b'
      - '\b\d{9}\b'

  - name: US_PHONE
    description: "US phone number formats"
    tier: 1
    language: "en"
    country: "US"
    patterns:
      - '(?<!\d)(?:\+1[-.\s]?)?\([2-9]\d{2}\)\s?[0-9]\d{2}[-.\s]?\d{4}(?!\d)'
      - '\b(?:\+1[-.\s]?)?[2-9]\d{2}[-.\s][0-9]\d{2}[-.\s]\d{4}\b'

  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  # Spanish Patterns
  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  - name: ES_NATIONAL_ID
    description: "Detects a Spanish Documento Nacional de Identidad (DNI) or NIE."
    tier: 1
    language: "es"
    country: "ES"
    patterns:
      - '\b[0-9]{8}[A-HJ-NP-TV-Z]\b'
      - '\b[XYZ][0-9]{7}[A-HJ-NP-TV-Z]\b'

  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  # German Patterns
  # - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

  - name: DE_TAX_ID
    description: "Detects a German Tax Identification Number (Steuer-IdNr)."
    tier: 1
    language: "de"
    country: "DE"
    patterns:
      - '\b[1-9]\d{1}\s?\d{3}\s?\d{2}\s?\d{3}\b'
      - '\b[1-9]\d([- ]?\d{4}){2}\b'

  - name: FR_PHONE_NUMBER
    description: "Detects common phone number formats in France."
    tier: 1
    language: "fr"
    country: "FR"
    patterns:
      - '\b0\s?[1-9](?:(?:\s?\d{2}){4}|\s?(?:\d{2}\s){3}\d{2})\b'

  - name: FR_SOCIAL_SECURITY
    description: "French Social Security Number (NIR)"
    tier: 1
    language: "fr"
    country: "FR"
    patterns:
      - '\b[1-2]\d{2}(0[1-9]|1[0-2])\d{2}\d{3}\d{3}\d{2}\b'

  - name: UK_NATIONAL_INSURANCE
    description: "UK National Insurance Number"
    tier: 1
    language: "en"
    country: "GB"
    patterns:
      - '\b[A-CEGHJ-PR-TW-Z][A-CEGHJ-NPR-TW-Z]\s?\d{2}\s?\d{2}\s?\d{2}\s?[A-D]\b'

  - name: CA_SOCIAL_INSURANCE
    description: "Canadian Social Insurance Number (SIN)"
    tier: 1
    language: "en"
    country: "CA"
    patterns:
      - '\b\d{3}[-\s]?\d{3}[-\s]?\d{3}\b'

  - name: INTERNATIONAL_PHONE
    description: "International phone numbers with country codes"
    tier: 2
    language: "universal"
    patterns:
      - '\b\+(?:44|33|49|81|86|91|61|55|39|34|31|46|47|41|43|32|30)[\s.-]?\d{1,4}[\s.-]?\d{3,4}[\s.-]?\d{3,8}\b'

