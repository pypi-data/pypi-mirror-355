{"version":3,"file":"datagrid-export.bundle.js","mappings":"slCAYA,IAKMA,EAAAA,WAKF,WAAYC,I,4FAAO,CAAD,QAEdC,KAAKD,KAAOA,EAEZC,KAAKC,a,QAsDR,O,EAjDL,G,EAAA,yBACI,WACID,KAAKD,KAAKG,iBAAiB,QAASF,KAAKG,OAAOC,KAAKJ,SACxD,yBAED,WAGI,IAFA,IAAID,EAAOC,KAAKD,KACZM,EAAI,GACAN,EAAKO,UAAUC,SAASC,EAAAA,KAI5B,GAHAH,IACAN,EAAOA,EAAKU,WAERJ,EA/BY,IAgCZ,KAAK,wBAAL,OAhCY,IAgCZ,qDAIR,OAAON,IAMf,oBACI,SAAOW,GACH,IAAMC,EAAWX,KAAKY,cAEhBC,EAAmB,EADHC,IAAAA,iBAAqBH,EAAUH,EAAAA,GAAgBO,EAAAA,GAAcC,EAAAA,KACvCC,KAAI,SAAAlB,GAAI,OAAIe,IAAAA,gBAAoBf,EAAMmB,EAAAA,OAIlF,IAH+BL,EAAiBM,MAAK,SAAApB,GAAI,OAAIA,EAAKqB,WAGrC,CACzBV,EAAEW,iBACF,IAAMC,EAAOR,IAAAA,gBAAoBH,EAAUH,EAAAA,GAAgBe,EAAAA,GAAcC,EAAAA,IACvDV,IAAAA,gBAAoBH,EAAUc,EAAAA,IAGtCL,SAAU,EACpBP,EAAiBa,SAAQ,SAAA3B,GACrBA,EAAKqB,SAAU,KAGnB,IAAMO,EAAcC,SAASC,cAAc,SAC3CF,EAAYG,KAAO9B,KAAKD,KAAK+B,KAC7BH,EAAYI,MAAQ/B,KAAKD,KAAKgC,MAC9BJ,EAAYK,KAAO,SACnBV,EAAKW,YAAYN,GACjBL,EAAKY,e,oEAEZ,EA/DCpC,GAoEN,EAAIqC,EAAAA,IAAkBT,SAAQ,SAAA3B,GAAI,OAAI,IAAID,EAAqBC","sources":["webpack://django-rijkshuisstijl/./rijkshuisstijl/js/components/datagrid/datagrid-export.js"],"sourcesContent":["import BEM from 'bem.js';\nimport {\n    BLOCK_DATAGRID,\n    DATAGRID_EXPORTS,\n    ELEMENT_CELL,\n    ELEMENT_FORM,\n    MODIFIER_ACTION,\n    MODIFIER_CHECKBOX\n} from './constants';\nimport {BLOCK_INPUT} from '../form/constants';\nimport {BLOCK_SELECT_ALL} from '../toggle/constants';\n\nconst MAX_ITERATION_COUNT = 100;\n\n/**\n * Makes sure data grid export buttons default to current page selection.\n */\nclass DataGridExportHelper {\n    /**\n     * Constructor method.\n     * @param {HTMLElement} node\n     */\n    constructor(node) {\n        /** @type {HTMLElement} */\n        this.node = node;\n\n        this.bindEvents();\n    }\n\n    /**\n     * Binds events to callbacks.\n     */\n    bindEvents() {\n        this.node.addEventListener('click', this.update.bind(this));\n    }\n\n    getDataGrid() {\n        let node = this.node;\n        let i = 0;\n        while (!node.classList.contains(BLOCK_DATAGRID)) {\n            i++;\n            node = node.parentNode;\n\n            if (i > MAX_ITERATION_COUNT) {\n                throw `MAX_ITERATION_COUNT (${MAX_ITERATION_COUNT}) reached while trying to find data grid element.`;\n            }\n        }\n\n        return node;\n    }\n\n    /**\n     * Checks all checkboxes in the data grid if none has been checked.\n     * @param {MouseEvent} e\n     */\n    update(e) {\n        const dataGrid = this.getDataGrid();\n        const checkboxCells = BEM.getChildBEMNodes(dataGrid, BLOCK_DATAGRID, ELEMENT_CELL, MODIFIER_CHECKBOX);\n        const checkboxesInputs = [...checkboxCells].map(node => BEM.getChildBEMNode(node, BLOCK_INPUT));\n        const selectedCheckboxInputs = checkboxesInputs.find(node => node.checked);\n\n        // Only check checkboxes if none hase been already checked.\n        if (!selectedCheckboxInputs) {\n            e.preventDefault();\n            const form = BEM.getChildBEMNode(dataGrid, BLOCK_DATAGRID, ELEMENT_FORM, MODIFIER_ACTION);\n            const selectAll = BEM.getChildBEMNode(dataGrid, BLOCK_SELECT_ALL);\n\n            // Select all checkboxes, including the \"select all\" toggle.\n            selectAll.checked = true;\n            checkboxesInputs.forEach(node => {\n                node.checked = true;\n            });\n\n            const hiddenInput = document.createElement('input');\n            hiddenInput.name = this.node.name;\n            hiddenInput.value = this.node.value;\n            hiddenInput.type = 'hidden';\n            form.appendChild(hiddenInput);\n            form.submit();\n        }\n    }\n}\n\n\n// Start!\n[...DATAGRID_EXPORTS].forEach(node => new DataGridExportHelper(node));\n"],"names":["DataGridExportHelper","node","this","bindEvents","addEventListener","update","bind","i","classList","contains","BLOCK_DATAGRID","parentNode","e","dataGrid","getDataGrid","checkboxesInputs","BEM","ELEMENT_CELL","MODIFIER_CHECKBOX","map","BLOCK_INPUT","find","checked","preventDefault","form","ELEMENT_FORM","MODIFIER_ACTION","BLOCK_SELECT_ALL","forEach","hiddenInput","document","createElement","name","value","type","appendChild","submit","DATAGRID_EXPORTS"],"sourceRoot":""}