{# bedrock-server-manager/bedrock_server_manager/web/templates/getting_started.html #}
{% extends "base.html" %}

{# --- Page Title --- #}
{% block title %}Getting Started - {{ super() }}{% endblock %}

{# --- Page Specific Styles --- #}
{% block head_styles %}
{{ super() }} {# Include styles from base if needed #}
    {# Include table styles if not already globally included/needed #}
<link rel="stylesheet" href="{{ url_for('static', filename='css/tables.css') }}">

<style>
    .getting-started-container {
        /* Content will inherit padding/styles from the main .container in base.html */
    }

        .getting-started-container h1 { /* Main Page Title */
            margin-bottom: 0.8em;
            padding-bottom: 0.5em; /* Added padding */
            border-bottom: 1px solid #666; /* Added border */
            font-size: 2em;
            color: #eee; /* Ensure color consistency */
        }

        .getting-started-container h2 { /* Major Section */
            margin-top: 2em;
            margin-bottom: 1em;
            padding-bottom: 0.5em;
            border-bottom: 1px solid #666;
            font-size: 1.8em;
            color: #eee; /* Match h1 color */
        }

        .getting-started-container h3 { /* Sub-Section */
            margin-top: 1.8em;
            margin-bottom: 0.8em;
            font-size: 1.4em;
            color: #e0e0e0;
            /* Optional: Add subtle border */
            /* border-bottom: 1px dotted #555; */
            /* padding-bottom: 0.3em; */
        }

        .getting-started-container h4 { /* Sub-Sub-Section */
            margin-top: 1.5em;
            margin-bottom: 0.6em;
            font-size: 1.2em;
            color: #dcdcdc;
        }

        .getting-started-container h5 { /* Smaller Sub-Section */
            margin-top: 1.3em;
            margin-bottom: 0.5em;
            font-size: 1.1em;
            font-weight: 600;
            color: #cccccc;
        }

        .getting-started-container p {
            line-height: 1.6;
            margin-bottom: 1em;
            color: #eee; /* Ensure consistent text color */
        }

        .getting-started-container ul,
        .getting-started-container ol {
            margin-left: 25px; /* Indentation */
            margin-bottom: 1.5em;
            padding-left: 15px; /* Add padding for list marker */
            color: #eee; /* Ensure consistent text color */
        }

            .getting-started-container ul ul,
            .getting-started-container ol ol {
                margin-top: 0.5em;
                margin-bottom: 1em;
                margin-left: 20px; /* Additional indent */
            }

        .getting-started-container li {
            margin-bottom: 0.6em;
            line-height: 1.5;
        }

        .getting-started-container code { /* Inline code */
            background-color: #4a4a4a;
            padding: 0.2em 0.4em;
            border-radius: 0; /* Match sharp corners */
            font-size: 0.9em;
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            color: #f0f0f0;
            word-break: break-word; /* Allow wrapping */
        }

        .getting-started-container pre { /* Code blocks */
            background-color: #282828; /* Darker code block bg */
            border: 1px solid #444; /* Slightly lighter border than default */
            padding: 12px 15px; /* Adjust padding */
            font-family: "Consolas", "Monaco", "Courier New", monospace;
            font-size: 0.9em;
            line-height: 1.4;
            overflow-x: auto;
            white-space: pre; /* Keep pre formatting for commands */
            border-radius: 0px;
            margin-top: 0.5em;
            margin-bottom: 1.5em;
            color: #e0e0e0;
            max-width: 100%; /* Prevent overflow */
            box-sizing: border-box;
        }

            .getting-started-container pre code { /* Reset inline style within pre */
                background-color: transparent;
                padding: 0;
                border-radius: 0;
                font-size: inherit;
                color: inherit;
                white-space: inherit; /* Inherit pre's whitespace handling */
                display: inline; /* Should be inline within pre */
                word-break: normal; /* Don't force break inside pre code */
            }

    /* Style for the back link */
    .back-to-docs-link {
        display: inline-block;
        margin-bottom: 1.5em;
        font-size: 0.95em;
    }

        .back-to-docs-link a {
            color: #90CAF9;
            text-decoration: none;
        }

            .back-to-docs-link a:hover {
                color: #BBDEFB;
                text-decoration: underline;
            }

    /* Table specific adjustments */
    .getting-started-container .table-responsive-wrapper {
        /* Inherits base styles, no extra needed unless override */
        margin-bottom: 1.5em; /* Add space after tables */
    }

    .getting-started-container .server-table th,
    .getting-started-container .server-table td {
        padding: 8px 12px; /* Slightly tighter padding */
        font-size: 0.95em;
        vertical-align: top; /* Align content top for readability */
        line-height: 1.4; /* Ensure consistent line height */
    }

        .getting-started-container .server-table td:nth-child(1) { /* Command name */
            white-space: nowrap; /* Prevent wrapping for command */
            font-weight: 600; /* Make command bold */
        }

        .getting-started-container .server-table td:nth-child(3) { /* Arguments */
            white-space: normal; /* Allow args to wrap if needed */
            word-break: break-word;
        }

            .getting-started-container .server-table td:nth-child(3) code {
                font-size: 0.9em; /* Slightly smaller code font in table */
                display: inline-block; /* Better spacing */
                margin-bottom: 2px; /* Space if args wrap */
            }

        .getting-started-container .server-table td:nth-child(4) { /* Platform */
            text-align: center;
            white-space: nowrap;
        }

    /* Disclaimer Box */
    .disclaimer-box {
        border-width: 1px;
        border-style: solid;
        padding: 15px 20px; /* Adjust padding */
        margin: 1.5em 0;
        border-radius: 0;
        color: #eee; /* Default text color */
    }
        /* Warning/Amber Box */
        .disclaimer-box.warning {
            border-color: #FFA000; /* Amber border */
            background-color: rgba(255, 160, 0, 0.1); /* Light amber background */
        }
        /* Info/Blue Box */
        .disclaimer-box.info {
            border-color: #1E88E5; /* Blue border */
            background-color: rgba(30, 136, 229, 0.1); /* Light blue background */
        }


        .disclaimer-box h4 {
            margin-top: 0;
            margin-bottom: 0.5em;
            font-size: 1.15em; /* Slightly larger */
            font-weight: 600;
        }

        .disclaimer-box.warning h4 {
            color: #FFB74D;
        }
        /* Lighter Amber */
        .disclaimer-box.info h4 {
            color: #90CAF9;
        }
        /* Lighter Blue */

        .disclaimer-box ul {
            margin-bottom: 0.5em;
            margin-left: 20px; /* Indent list within box */
            padding-left: 10px;
        }

            .disclaimer-box ul ul {
                margin-left: 15px; /* Further indent nested lists */
            }

        .disclaimer-box li {
            margin-bottom: 0.4em;
        }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        .getting-started-container h1 {
            font-size: 1.8em;
        }

        .getting-started-container h2 {
            font-size: 1.6em;
            margin-top: 1.8em;
        }

        .getting-started-container h3 {
            font-size: 1.3em;
            margin-top: 1.6em;
        }

        .getting-started-container h4 {
            font-size: 1.15em;
            margin-top: 1.4em;
        }

        .getting-started-container h5 {
            font-size: 1.05em;
            margin-top: 1.2em;
        }

        .getting-started-container ol,
        .getting-started-container ul {
            margin-left: 20px;
            padding-left: 10px;
        }

        .getting-started-container .server-table th,
        .getting-started-container .server-table td {
            font-size: 0.9em;
            padding: 6px 10px;
        }

        .disclaimer-box {
            padding: 12px 15px;
        }
    }

    @media (max-width: 480px) {
        .getting-started-container h1 {
            font-size: 1.6em;
        }

        .getting-started-container h2 {
            font-size: 1.45em;
            margin-top: 1.6em;
        }

        .getting-started-container h3 {
            font-size: 1.25em;
            margin-top: 1.5em;
        }

        .getting-started-container h4 {
            font-size: 1.1em;
            margin-top: 1.3em;
        }

        .getting-started-container h5 {
            font-size: 1em;
            margin-top: 1.1em;
        }

        .getting-started-container ol,
        .getting-started-container ul {
            margin-left: 15px;
            padding-left: 10px;
        }

        .getting-started-container pre {
            font-size: 0.85em;
            padding: 10px;
        }

        .getting-started-container code {
            font-size: 0.85em;
        }

        .getting-started-container .server-table th,
        .getting-started-container .server-table td {
            font-size: 0.85em;
            padding: 5px 8px;
        }

            .getting-started-container .server-table td:nth-child(1), /* Command name */
            .getting-started-container .server-table td:nth-child(4) { /* Platform */
                white-space: normal; /* Allow wrapping on very small screens */
            }

        .disclaimer-box {
            padding: 10px 12px;
        }

            .disclaimer-box h4 {
                font-size: 1.1em;
            }
    }

    .docs-index-list {
        list-style: none; /* Remove default bullets */
        padding-left: 0;
        margin-top: 1.5em;
    }

        .docs-index-list li {
            margin-bottom: 1em;
            font-size: 1.1em;
        }

        .docs-index-list a {
            color: #90CAF9; /* Light blue link color */
            text-decoration: none;
            font-weight: 600;
            padding: 5px 0; /* Add some vertical padding for easier clicking */
            transition: color 0.2s ease;
        }

            .docs-index-list a:hover {
                color: #BBDEFB; /* Lighter blue on hover */
                text-decoration: underline;
            }
        /* Style for the description paragraph */
        .docs-index-list p {
            font-size: 0.9em;
            color: #bbb;
            margin-top: 3px;
            margin-left: 5px; /* Slight indent for description */
            line-height: 1.4;
        }
</style>
{% endblock %}


{# --- Main Content --- #}
{% block content %}
<div class="getting-started-container">

    <h1>Bedrock Server Manager</h1>

    {# --- Link back to the Documentation Index --- #}
    <p class="back-to-docs-link">
        <a href="{{ url_for('doc_routes.doc_index') }}">← Back to Documentation Index</a>
    </p>

    <p>Bedrock Server Manager is a comprehensive python package designed for installing, managing, and maintaining Minecraft Bedrock Dedicated Servers with ease, and is Linux/Windows compatable.</p>

{# --- CHANGELOG Link --- #}
<ul class="docs-index-list">
    {# Link to Changelog #}
    <a href="{{ url_for('doc_routes.changelog') }}">Changelog</a>
</ul>

    <h2>Features</h2>
    <ul>
        <li>Install New Servers: Quickly set up a server with customizable options like version (LATEST, PREVIEW, or specific versions).</li>
        <li>Update Existing Servers: Seamlessly download and update server files while preserving critical configuration files and backups.</li>
        <li>Backup Management: Automatically backup worlds and configuration files, with pruning for older backups.</li>
        <li>Server Configuration: Easily modify server properties, and allow-list interactively.</li>
        <li>Auto-Update supported: Automatically update the server with a simple restart.</li>
        <li>Command-Line Tools: Send game commands, start, stop, and restart servers directly from the command line.</li>
        <li>Interactive Menu: Access a user-friendly interface to manage servers without manually typing commands.</li>
        <li>Install/Update Content: Easily import <code>.mcworld</code>/<code>.mcpack</code> files into your server.</li>
        <li>Automate Various Server Task: Quickly create cron/task to automate task such as backup-server or restart-server.</li>
        <li>View Resource Usage: View how much CPU and RAM your server is using.</li>
        <li>Web Server: Easily manage your Minecraft servers in your browser, even if you're on mobile!</li>
    </ul>

    <h2>Prerequisites</h2>
    <p>This app requires <code>Python 3.10</code> or later, and you will need <code>pip</code> installed.</p>
    <p>On Linux, you'll also need:</p>
    <ul>
        <li><code>screen</code></li>
        <li><code>systemd</code></li>
    </ul>

    <h2>Installation</h2>
    <h3>Install The Package:</h3>
    <ol>
        <li>Run the command:</li>
    </ol>
    <pre><code class="language-bash">pip install bedrock-server-manager</code></pre>

    <h2>Configuration</h2>
    <h3>Setup The Configuration:</h3>
    <p>bedrock-server-manager will use the Environment Variable <code>BEDROCK_SERVER_MANAGER_DATA_DIR</code> for setting the default config/data location, if this variable does not exist it will default to <code>$HOME/bedrock-server-manager</code> (Linux/macOS) or the user's home directory equivalent (Windows).</p>
    <p>Follow your platform's documentation for setting Environment Variables.</p>
    <p>The app will create its data folders in this location. This is where servers will be installed to and where the app will look when managing various server aspects.</p>
    <p>Certain variables can can be changed directly in the <code><DATA_DIR>/.config/script_config.json</code> or with the <code>manage-script-config</code> command.</p>

    <h4>The following variables are configurable via json</h4>
    <ul>
        <li><code>BASE_DIR</code>: Directory where servers will be installed</li>
        <li><code>CONTENT_DIR</code>: Directory where the app will look for addons/worlds</li>
        <li><code>DOWNLOAD_DIR</code>: Directory where servers will download</li>
        <li><code>BACKUP_DIR</code>: Directory where server backups will go</li>
        <li><code>LOG_DIR</code>: Directory where app logs will be saved</li>
        <li><code>BACKUP_KEEP</code>: How many backups to keep</li>
        <li><code>DOWNLOAD_KEEP</code>: How many server downloads to keep</li>
        <li><code>LOGS_KEEP</code>: How many logs to keep</li>
        <li><code>LOG_LEVEL</code>: Level for logging.</li>
        <li><code>WEB_PORT</code>: Port used by the web server. 11325 by default</li>
        <li><code>TOKEN_EXPIRES_WEEKS</code>: How long JWT tokens are vaild for in weeks.</li>
    </ul>

    <h2>Usage</h2>
    {# --- CLI Commands Link (External) --- #}
    <p>For a complete list of commands, run <code class="language-bash">bedrock-server-manager <command> --help</code> from the Bedrock Server Manager host CLI</p>
    <h3>Run the app:</h3>
    <pre><code class="language-bash">bedrock-server-manager <command> [options]</code></pre>

    <h5>Examples:</h5>
    <p>Open Main Menu:</p>
    <pre><code class="language-bash">bedrock-server-manager main</code></pre>
    <p>Send Command:</p>
    <pre><code class="language-bash">bedrock-server-manager send-command --server server_name --command "tell @a hello"</code></pre>
    <p>Manage Script Config:</p>
    <pre><code class="language-bash">bedrock-server-manager manage-script-config --key BACKUP_KEEP --operation write --value 5</code></pre>
    <p>Start the Web Server:</p>
    <pre><code class="language-bash">bedrock-server-manager start-web-server --host 0.0.0.0 "::" --mode direct</code></pre>

    <h2>Install Content:</h2>
    <p>Easily import addons and worlds into your servers. The app will look in the configured <code>CONTENT_DIR</code> directories for addon files.</p>
    <p>Place <code>.mcworld</code> files in <code><CONTENT_DIR>/worlds</code> or <code>.mcpack</code>/<code>.mcaddon</code> files in <code><CONTENT_DIR>/addons</code></p>
    <p>Use the interactive menu to choose which file to install or use the command:</p>
    <pre><code class="language-bash">bedrock-server-manager install-world --server server_name --file '/path/to/WORLD.mcworld'</code></pre>
    <pre><code class="language-bash">bedrock-server-manager install-addon --server server_name --file '/path/to/ADDON.mcpack'</code></pre>

    <h2>Web Server:</h2>
    <p>Bedrock Server Manager 3.1.0 includes a Web server you can run to easily manage your bedrock servers in your web browser, and is also mobile friendly!</p>
    <p>The web ui has full parity with the CLI. With the web server you can:</p>
    <ul>
        <li>Install New Server</li>
        <li>Configure various server config files such as allowlist and permissions</li>
        <li>Start/Stop/Restart Bedrock server</li>
        <li>Update/Delete Bedrock server</li>
        <li>Monitor resource usage</li>
        <li>Schedule cron/task</li>
        <li>Install world/addons</li>
        <li>Backup and Restore all or individual files/worlds</li>
    </ul>

    <h3>Configure the Web Server:</h3>

    <h4>Environment Variables:</h4>
    <p>To get started using the web server you must first set these environment variables:</p>
    <ul>
        <li><strong><code>BEDROCK_SERVER_MANAGER_USERNAME</code></strong>: Required. Plain text username for web UI and API login. <strong>The web server will not start if this is not set</strong></li>
        <li><strong><code>BEDROCK_SERVER_MANAGER_PASSWORD</code></strong>: Required. Hashed password for web UI and API login. Use the generate-password utility. <strong>The web server will not start if this is not set</strong></li>
        <li><strong><code>BEDROCK_SERVER_MANAGER_SECRET</code></strong>: Recommended. A long, random, secret string. If not set, a temporary key is generated, and web UI sessions will not persist across restarts, and will require reauthentication.</li>
        <li><strong><code>BEDROCK_SERVER_MANAGER_TOKEN</code></strong>: Recommended. A long, random, secret string (different from _SECRET). If not set, a temporary key is generated, and JWT tokens used for API authentication will become invalid across restarts. <strong>JWT tokens expire every 4 weeks by default</strong></li>
    </ul>
    <p>Follow your platform's documentation for setting Environment Variables.</p>

    <h4>Generate Password Hash:</h4>
    <p>For the web server to start you must first set the <code>BEDROCK_SERVER_MANAGER_PASSWORD</code> environment variable.</p>
    <p>This must be set to the password hash and NOT the plain text password.</p>
    <p>Use the following command to generate a password:</p>
    <pre><code class="language-bash">bedrock-server-manager generate-password</code></pre>
    <p>Follow the on-screen prompt to hash your password.</p>

    <h4>Hosts:</h4>
    <p>By Default Bedrock Server Manager will only listen to local host only interfaces <code>127.0.0.1</code> and <code>[::1]</code>.</p>
    <p>To change which host to listen to start the web server with the specified host.</p>
    <p>Example: specify local host only ipv4 and ipv6:</p>
    <pre><code class="language-bash">bedrock-server-manager start-web-server --host 127.0.0.1 "::1"</code></pre>
    <p>Example: specify all ipv4 and ipv6 addresses:</p>
    <pre><code class="language-bash">bedrock-server-manager start-web-server --host 0.0.0.0 "::"</code></pre>

    <h4>Port:</h4>
    <p>By default Bedrock Server Manager will use port <code>11325</code>. This can be changed in <code>script_config.json</code>:</p>
    <pre><code class="language-bash">bedrock-server-manager manage-script-config --key WEB_PORT --operation write --value 11325</code></pre>

    <h4>HTTP API:</h4>
    <p>An HTTP API is provided allowing tools like <code>curl</code> or <code>Invoke-RestMethod</code> to interact with the server.</p>
    <p>Before using the API, ensure the following environment variables are set on the system running the app:</p>
    <ul>
        <li><code>BEDROCK_SERVER_MANAGER_TOKEN</code>: <strong>REQUIRED</strong> for token persistence across server restarts</li>
        <li><code>BEDROCK_SERVER_MANAGER_USERNAME</code>: The username for API login.</li>
        <li><code>BEDROCK_SERVER_MANAGER_PASSWORD</code>: The hashed password for API login</li>
    </ul>

    <h5>Obtaining a JWT token:</h5>
    <p>The API endpoints require authentication using a JSON Web Token (JWT).</p>
    <p><strong>How:</strong> Obtain a token by sending a POST request to the <code>/api/login</code> endpoint.</p>
    <p><strong>Request Body:</strong> Include a JSON payload with <code>username</code> and <code>password</code> keys, matching the values set in the environment variables.</p>
    <pre><code class="language-json">{
    "username": "username",
    "password": "password"
}</code></pre>
    <p><strong>Response:</strong> On success, the API returns a JSON object containing the <code>access_token</code>:</p>
    <pre><code class="language-json">{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}</code></pre>
    <p>Tokens expire after the configured duration (default: 4 weeks).</p>

    <h6><code>curl</code> Example (Bash):</h6>
    <pre><code class="language-bash">curl -X POST -H "Content-Type: application/json" \
     -d '{"username": "your_username", "password": "your_password"}' \
     http://<your-manager-host>:<port>/api/login</code></pre>

    <h6>PowerShell Example:</h6>
    <pre><code class="language-powershell">$body = @{ username = 'your_username'; password = 'your_password' } | ConvertTo-Json
Invoke-RestMethod -Method Post -Uri "http://<your-manager-host>:<port>/api/login" -Body $body -ContentType 'application/json'</code></pre>

    <h5>Using the API</h5>
    <p>Endpoints requiring authentication will need the obtained <code>access_token</code> included in the <code>Authorization</code> header of your requests:</p>
    <pre><code>Authorization: Bearer YOUR_JWT_TOKEN</code></pre>
    <p>For requests sending data (like POST or PUT), set the <code>Content-Type</code> header to <code>application/json</code>.</p>

    <h5>Examples:</h5>
    <p>Start server:</p>
    <h6><code>curl</code> Example (Bash):</h6>
    <pre><code class="language-bash">curl -X POST -H "Authorization: Bearer YOUR_JWT_TOKEN" \
     http://<your-manager-host>:<port>/api/server/<server_name>/start</code></pre>

    <h6>PowerShell Example:</h6>
    <pre><code class="language-powershell">$headers = @{ Authorization = 'Bearer YOUR_JWT_TOKEN' }
Invoke-RestMethod -Method Post -Uri "http://<your-manager-host>:<port>/api/server/<server_name>/start" -Headers $headers</code></pre>

    <p>Send Command:</p>
    <h6><code>curl</code> Example (Bash):</h6>
    <pre><code class="language-bash">curl -X POST -H "Authorization: Bearer YOUR_JWT_TOKEN" -H "Content-Type: application/json" \
     -d '{"command": "say Hello from API!"}' \
     http://<your-manager-host>:<port>/api/server/<server_name>/send_command</code></pre>

    <h6>PowerShell Example:</h6>
    <pre><code class="language-powershell">$headers = @{ Authorization = 'Bearer YOUR_JWT_TOKEN'; 'Content-Type' = 'application/json' }
$body = @{ command = 'say Hello from API!' } | ConvertTo-Json
Invoke-RestMethod -Method Post -Uri "http://<your-manager-host>:<port>/api/server/<server_name>/send_command" -Headers $headers -Body $body</code></pre>

    {# --- HTTP API Link --- #}
    <ul class="docs-index-list">
        <a href="{{ url_for('doc_routes.api_docs') }}">Full HTTP API Documentation</a>
    </ul>

    <h2>Disclaimers:</h2>
    <div class="disclaimer-box warning">
        <h4>Platform Differences:</h4>
        <ul>
            <li>
                Windows suppport has the following limitations such as:
                <ul>
                    <li><code>send-command</code> requires seperate start method (no yet available)</li>
                    <li>No attach to console support</li>
                    <li>No service integration</li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="disclaimer-box info">
        <h4>Tested on these systems:</h4>
        <ul>
            <li>Debian 12 (bookworm)</li>
            <li>Ubuntu 24.04</li>
            <li>Windows 11 24H2</li>
            <li>WSL2</li>
        </ul>
    </div>

    {# --- Optional: Back link at the bottom --- #}
    <hr style="margin-top: 3em; border: 0; height: 1px; background-color: #555;">
    <p class="back-to-docs-link">
        <a href="{{ url_for('doc_routes.doc_index') }}">← Back to Documentation Index</a>
    </p>

</div> {# End .getting-started-container #}
{% endblock %}

{# --- Page Specific Body Scripts (Optional) --- #}
{% block body_scripts %}
{{ super() }}
    {# Add any JS specific to this page if needed #}
{% endblock %}