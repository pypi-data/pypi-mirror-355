Traceback (most recent call last):
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/sc-projects/sc-proj-dh-ukb-intergenics/envs/networkvi_py310/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
rna_multiome_path = "neurips2021_multiome_bmmc_luecken2021.h5ad"

try:
    rna_multiome = sc.read_h5ad(rna_multiome_path)
except OSError:
    import gdown

    gdown.download("https://drive.google.com/uc?export=download&id=1lG6MtzEzBWLBilihWtTCYAyMdU5Jbcud")
    rna_multiome = sc.read_h5ad(rna_multiome_path)

rna_multiome
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mFileNotFoundError[0m                         Traceback (most recent call last)
Cell [0;32mIn[8], line 4[0m
[1;32m      3[0m [38;5;28;01mtry[39;00m:
[0;32m----> 4[0m     rna_multiome [38;5;241m=[39m [43msc[49m[38;5;241;43m.[39;49m[43mread_h5ad[49m[43m([49m[43mrna_multiome_path[49m[43m)[49m
[1;32m      5[0m [38;5;28;01mexcept[39;00m [38;5;167;01mOSError[39;00m:

File [0;32m/sc-projects/sc-proj-dh-ukb-intergenics/envs/scvi_tools_develop_arnoldtl5/lib/python3.10/site-packages/anndata/_io/h5ad.py:237[0m, in [0;36mread_h5ad[0;34m(filename, backed, as_sparse, as_sparse_fmt, chunk_size)[0m
[1;32m    233[0m rdasp [38;5;241m=[39m partial(
[1;32m    234[0m     read_dense_as_sparse, sparse_format[38;5;241m=[39mas_sparse_fmt, axis_chunk[38;5;241m=[39mchunk_size
[1;32m    235[0m )
[0;32m--> 237[0m [38;5;28;01mwith[39;00m [43mh5py[49m[38;5;241;43m.[39;49m[43mFile[49m[43m([49m[43mfilename[49m[43m,[49m[43m [49m[38;5;124;43m"[39;49m[38;5;124;43mr[39;49m[38;5;124;43m"[39;49m[43m)[49m [38;5;28;01mas[39;00m f:
[1;32m    239[0m     [38;5;28;01mdef[39;00m [38;5;21mcallback[39m(func, elem_name: [38;5;28mstr[39m, elem, iospec):

File [0;32m/sc-projects/sc-proj-dh-ukb-intergenics/envs/scvi_tools_develop_arnoldtl5/lib/python3.10/site-packages/h5py/_hl/files.py:562[0m, in [0;36mFile.__init__[0;34m(self, name, mode, driver, libver, userblock_size, swmr, rdcc_nslots, rdcc_nbytes, rdcc_w0, track_order, fs_strategy, fs_persist, fs_threshold, fs_page_size, page_buf_size, min_meta_keep, min_raw_keep, locking, alignment_threshold, alignment_interval, meta_block_size, **kwds)[0m
[1;32m    559[0m     fcpl [38;5;241m=[39m make_fcpl(track_order[38;5;241m=[39mtrack_order, fs_strategy[38;5;241m=[39mfs_strategy,
[1;32m    560[0m                      fs_persist[38;5;241m=[39mfs_persist, fs_threshold[38;5;241m=[39mfs_threshold,
[1;32m    561[0m                      fs_page_size[38;5;241m=[39mfs_page_size)
[0;32m--> 562[0m     fid [38;5;241m=[39m [43mmake_fid[49m[43m([49m[43mname[49m[43m,[49m[43m [49m[43mmode[49m[43m,[49m[43m [49m[43muserblock_size[49m[43m,[49m[43m [49m[43mfapl[49m[43m,[49m[43m [49m[43mfcpl[49m[43m,[49m[43m [49m[43mswmr[49m[38;5;241;43m=[39;49m[43mswmr[49m[43m)[49m
[1;32m    564[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(libver, [38;5;28mtuple[39m):

File [0;32m/sc-projects/sc-proj-dh-ukb-intergenics/envs/scvi_tools_develop_arnoldtl5/lib/python3.10/site-packages/h5py/_hl/files.py:235[0m, in [0;36mmake_fid[0;34m(name, mode, userblock_size, fapl, fcpl, swmr)[0m
[1;32m    234[0m         flags [38;5;241m|[39m[38;5;241m=[39m h5f[38;5;241m.[39mACC_SWMR_READ
[0;32m--> 235[0m     fid [38;5;241m=[39m [43mh5f[49m[38;5;241;43m.[39;49m[43mopen[49m[43m([49m[43mname[49m[43m,[49m[43m [49m[43mflags[49m[43m,[49m[43m [49m[43mfapl[49m[38;5;241;43m=[39;49m[43mfapl[49m[43m)[49m
[1;32m    236[0m [38;5;28;01melif[39;00m mode [38;5;241m==[39m [38;5;124m'[39m[38;5;124mr+[39m[38;5;124m'[39m:

File [0;32mh5py/_objects.pyx:54[0m, in [0;36mh5py._objects.with_phil.wrapper[0;34m()[0m

File [0;32mh5py/_objects.pyx:55[0m, in [0;36mh5py._objects.with_phil.wrapper[0;34m()[0m

File [0;32mh5py/h5f.pyx:102[0m, in [0;36mh5py.h5f.open[0;34m()[0m

[0;31mFileNotFoundError[0m: [Errno 2] Unable to synchronously open file (unable to open file: name = 'neurips2021_multiome_bmmc_luecken2021.h5ad', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)

During handling of the above exception, another exception occurred:

[0;31mFileURLRetrievalError[0m                     Traceback (most recent call last)
File [0;32m/sc-projects/sc-proj-dh-ukb-intergenics/envs/scvi_tools_develop_arnoldtl5/lib/python3.10/site-packages/gdown/download.py:267[0m, in [0;36mdownload[0;34m(url, output, quiet, proxy, speed, use_cookies, verify, id, fuzzy, resume, format, user_agent, log_messages)[0m
[1;32m    266[0m [38;5;28;01mtry[39;00m:
[0;32m--> 267[0m     url [38;5;241m=[39m [43mget_url_from_gdrive_confirmation[49m[43m([49m[43mres[49m[38;5;241;43m.[39;49m[43mtext[49m[43m)[49m
[1;32m    268[0m [38;5;28;01mexcept[39;00m FileURLRetrievalError [38;5;28;01mas[39;00m e:

File [0;32m/sc-projects/sc-proj-dh-ukb-intergenics/envs/scvi_tools_develop_arnoldtl5/lib/python3.10/site-packages/gdown/download.py:55[0m, in [0;36mget_url_from_gdrive_confirmation[0;34m(contents)[0m
[1;32m     54[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m url:
[0;32m---> 55[0m     [38;5;28;01mraise[39;00m FileURLRetrievalError(
[1;32m     56[0m         [38;5;124m"[39m[38;5;124mCannot retrieve the public link of the file. [39m[38;5;124m"[39m
[1;32m     57[0m         [38;5;124m"[39m[38;5;124mYou may need to change the permission to [39m[38;5;124m"[39m
[1;32m     58[0m         [38;5;124m"[39m[38;5;124m'[39m[38;5;124mAnyone with the link[39m[38;5;124m'[39m[38;5;124m, or have had many accesses. [39m[38;5;124m"[39m
[1;32m     59[0m         [38;5;124m"[39m[38;5;124mCheck FAQ in https://github.com/wkentaro/gdown?tab=readme-ov-file#faq.[39m[38;5;124m"[39m,
[1;32m     60[0m     )
[1;32m     61[0m [38;5;28;01mreturn[39;00m url

[0;31mFileURLRetrievalError[0m: Cannot retrieve the public link of the file. You may need to change the permission to 'Anyone with the link', or have had many accesses. Check FAQ in https://github.com/wkentaro/gdown?tab=readme-ov-file#faq.

During handling of the above exception, another exception occurred:

[0;31mFileURLRetrievalError[0m                     Traceback (most recent call last)
Cell [0;32mIn[8], line 8[0m
[1;32m      5[0m [38;5;28;01mexcept[39;00m [38;5;167;01mOSError[39;00m:
[1;32m      6[0m     [38;5;28;01mimport[39;00m [38;5;21;01mgdown[39;00m
[0;32m----> 8[0m     [43mgdown[49m[38;5;241;43m.[39;49m[43mdownload[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43mhttps://drive.google.com/uc?export=download&id=1lG6MtzEzBWLBilihWtTCYAyMdU5Jbcud[39;49m[38;5;124;43m"[39;49m[43m)[49m
[1;32m      9[0m     rna_multiome [38;5;241m=[39m sc[38;5;241m.[39mread_h5ad(rna_multiome_path)
[1;32m     11[0m rna_multiome

File [0;32m/sc-projects/sc-proj-dh-ukb-intergenics/envs/scvi_tools_develop_arnoldtl5/lib/python3.10/site-packages/gdown/download.py:278[0m, in [0;36mdownload[0;34m(url, output, quiet, proxy, speed, use_cookies, verify, id, fuzzy, resume, format, user_agent, log_messages)[0m
[1;32m    268[0m     [38;5;28;01mexcept[39;00m FileURLRetrievalError [38;5;28;01mas[39;00m e:
[1;32m    269[0m         message [38;5;241m=[39m (
[1;32m    270[0m             [38;5;124m"[39m[38;5;124mFailed to retrieve file url:[39m[38;5;130;01m\n[39;00m[38;5;130;01m\n[39;00m[38;5;132;01m{}[39;00m[38;5;130;01m\n[39;00m[38;5;130;01m\n[39;00m[38;5;124m"[39m
[1;32m    271[0m             [38;5;124m"[39m[38;5;124mYou may still be able to access the file from the browser:[39m[38;5;124m"[39m
[0;32m   (...)[0m
[1;32m    276[0m             url_origin,
[1;32m    277[0m         )
[0;32m--> 278[0m         [38;5;28;01mraise[39;00m FileURLRetrievalError(message)
[1;32m    280[0m filename_from_url [38;5;241m=[39m [38;5;28;01mNone[39;00m
[1;32m    281[0m last_modified_time [38;5;241m=[39m [38;5;28;01mNone[39;00m

[0;31mFileURLRetrievalError[0m: Failed to retrieve file url:

	Cannot retrieve the public link of the file. You may need to change
	the permission to 'Anyone with the link', or have had many accesses.
	Check FAQ in https://github.com/wkentaro/gdown?tab=readme-ov-file#faq.

You may still be able to access the file from the browser:

	https://drive.google.com/uc?export=download&id=1lG6MtzEzBWLBilihWtTCYAyMdU5Jbcud

but Gdown can't. Please check connections and permissions.

