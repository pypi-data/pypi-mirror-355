.PHONY: help version build test clean install-dev format lint

# ê¸°ë³¸ ëª©í‘œ
help:
	@echo "ğŸš€ {{ project_name }} ê°œë°œ ë„êµ¬"
	@echo ""
	@echo "ê°œë°œ ë„êµ¬:"
	@echo "  install-dev         - ê°œë°œ í™˜ê²½ ì„¤ì¹˜"
	@echo "  test               - í…ŒìŠ¤íŠ¸ ì‹¤í–‰"
	@echo "  format             - ì½”ë“œ í¬ë§¤íŒ…"
	@echo "  lint               - ì½”ë“œ ë¦°íŒ…"
	@echo ""
	@echo "ë²„ì „ ê´€ë¦¬:"
	@echo "  version             - í˜„ì¬ ë²„ì „ í™•ì¸"
	@echo "  tag-patch           - íŒ¨ì¹˜ ë²„ì „ íƒœê·¸ ìƒì„±"
	@echo "  tag-minor           - ë§ˆì´ë„ˆ ë²„ì „ íƒœê·¸ ìƒì„±"
	@echo "  tag-major           - ë©”ì´ì € ë²„ì „ íƒœê·¸ ìƒì„±"
	@echo ""
	@echo "ë¹Œë“œ ë° ë°°í¬:"
	@echo "  build              - íŒ¨í‚¤ì§€ ë¹Œë“œ"
	@echo "  clean              - ë¹Œë“œ ì•„í‹°íŒ©íŠ¸ ì •ë¦¬"

# ê°œë°œ ë„êµ¬
install-dev:
	@echo "ğŸ”§ ê°œë°œ í™˜ê²½ ì„¤ì¹˜ ì¤‘..."
	@pip install -e ".[dev]"
	@echo "âœ… ê°œë°œ í™˜ê²½ ì„¤ì¹˜ ì™„ë£Œ"

test:
	@echo "ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘..."
	@pytest tests/ -v

format:
	@echo "ğŸ¨ ì½”ë“œ í¬ë§¤íŒ… ì¤‘..."
	@ruff format .

lint:
	@echo "ğŸ” ì½”ë“œ ë¦°íŒ… ì¤‘..."
	@ruff check .

# ë²„ì „ ê´€ë¦¬ (setuptools-scm ê¸°ë°˜)
version:
	@echo "ğŸ·ï¸ í˜„ì¬ ë²„ì „:"
	@python -c "import {{ project_slug }}; print({{ project_slug }}.__version__)"

tag-patch:
	@echo "ğŸ“ˆ íŒ¨ì¹˜ ë²„ì „ íƒœê·¸ ìƒì„± ì¤‘..."
	@python -c "import subprocess; import {{ project_slug }}; current={{ project_slug }}.__version__.split('.'); new=f'{current[0]}.{current[1]}.{int(current[2])+1}'; subprocess.run(['git', 'tag', '-a', new, '-m', f'Release {new}']); print(f'ğŸ·ï¸ íƒœê·¸ ìƒì„±: {new}')"

tag-minor:
	@echo "ğŸ“ˆ ë§ˆì´ë„ˆ ë²„ì „ íƒœê·¸ ìƒì„± ì¤‘..."
	@python -c "import subprocess; import {{ project_slug }}; current={{ project_slug }}.__version__.split('.'); new=f'{current[0]}.{int(current[1])+1}.0'; subprocess.run(['git', 'tag', '-a', new, '-m', f'Release {new}']); print(f'ğŸ·ï¸ íƒœê·¸ ìƒì„±: {new}')"

tag-major:
	@echo "ğŸ“ˆ ë©”ì´ì € ë²„ì „ íƒœê·¸ ìƒì„± ì¤‘..."
	@python -c "import subprocess; import {{ project_slug }}; current={{ project_slug }}.__version__.split('.'); new=f'{int(current[0])+1}.0.0'; subprocess.run(['git', 'tag', '-a', new, '-m', f'Release {new}']); print(f'ğŸ·ï¸ íƒœê·¸ ìƒì„±: {new}')"

# ë¹Œë“œ ë° ë°°í¬
build: clean
	@echo "ğŸ“¦ íŒ¨í‚¤ì§€ ë¹Œë“œ ì¤‘..."
	@python -m build
	@echo "âœ… ë¹Œë“œ ì™„ë£Œ: dist/"

clean:
	@echo "ğŸ§¹ ì •ë¦¬ ì¤‘..."
	@rm -rf dist/
	@rm -rf build/
	@rm -rf *.egg-info/
	@find . -type d -name __pycache__ -exec rm -rf {} +
	@find . -type f -name "*.pyc" -delete
	@echo "âœ… ì •ë¦¬ ì™„ë£Œ" 