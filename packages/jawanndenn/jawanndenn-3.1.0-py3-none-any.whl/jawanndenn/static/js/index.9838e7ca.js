(()=>{"use strict";var e={6870:function(e,t,n){var r=n(5893),s=n(7294),i=n(745);let o=()=>(0,r.jsx)("footer",{children:(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{fontSize:"150%",position:"relative",top:"3px"},children:"★"}),(0,r.jsx)("a",{href:"https://github.com/hartwork/jawanndenn/",children:"jawanndenn"})," is"," ",(0,r.jsx)("a",{href:"https://www.gnu.org/philosophy/free-sw.en.html",children:"software libre"})," ","developed by ",(0,r.jsx)("a",{href:"https://blog.hartwork.org/",children:"Sebastian Pipping"}),", licensed under the"," ",(0,r.jsx)("a",{href:"https://www.gnu.org/licenses/agpl.en.html",children:"GNU Affero GPL license"}),". Please"," ",(0,r.jsx)("a",{href:"https://github.com/hartwork/jawanndenn/issues",children:"report bugs"})," ","and let me know if you ",(0,r.jsx)("a",{href:"mailto:sebastian@pipping.org",children:"like"})," ","it.",(0,r.jsx)("iframe",{id:"github-star-button",src:"./static/3rdparty/github-buttons-4.0.1/docs/github-btn.html?user=hartwork&repo=jawanndenn&type=star&count=true",frameBorder:"0",scrolling:"0",width:"170px",height:"20px"})]})}),l=[["**","<strong>","</strong>"],["*","<em>","</em>"],["__","<strong>","</strong>"],["_","<em>","</em>"],["`","<tt>","</tt>"]],a={};l.forEach(e=>{let t=e[0],n=e[2];a[t]=n});let c=e=>{e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let t=[],n=[];for(;e.length;){let r=!1;l.forEach(s=>{let i=s[0],o=s[1],l=s[2];if(e.startsWith(i))return n.length&&n[n.length-1]==i?(t.push(l),n.pop()):(t.push(o),n.push(i)),e=e.slice(i.length),r=!0,!1}),r||(t.push(e[0]),e=e.slice(1))}return n.reverse(),n.forEach(e=>{t.push(a[e])}),t.join("")};var d=n(5237),h=n(3321);let u=(0,h.Z)((0,r.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),p=(0,h.Z)((0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),m=(0,h.Z)((0,r.jsx)("path",{d:"m 5.0006855,3.0002915 c -1.1,0 -2.000394,0.899878 -2.000394,1.999878 V 18.999831 c 0,1.1 0.900394,2.000395 2.000394,2.000395 H 19.000348 c 1.1,0 1.999878,-0.900395 1.999878,-2.000395 V 5.0001695 c 0,-1.1 -0.899878,-1.999878 -1.999878,-1.999878 z m 7.0295445,3.420463 c 1.049909,0 1.86985,0.254855 2.459799,0.764811 0.589948,0.504956 0.885217,1.229626 0.885217,2.174544 0,0.6549425 -0.185037,1.2028315 -0.555005,1.6427935 -0.364968,0.434963 -0.792652,0.882077 -1.282609,1.342037 -0.279976,0.249978 -0.47,0.514808 -0.569991,0.794784 -0.09999,0.279975 -0.154849,0.610153 -0.164848,0.99012 h -1.919779 c 0.005,-0.674942 0.08755,-1.222313 0.24753,-1.642277 0.164986,-0.419963 0.462489,-0.822712 0.892452,-1.207678 0.344969,-0.304974 0.627512,-0.594739 0.847493,-0.869714 0.224981,-0.274977 0.337447,-0.5924275 0.337447,-0.9523965 0,-0.844926 -0.392773,-1.267623 -1.177706,-1.267623 -0.309973,0 -0.589763,0.100257 -0.839742,0.30024 -0.249978,0.199983 -0.380158,0.525173 -0.390157,0.975134 H 8.6257875 c 0.015,-1.039909 0.347412,-1.807744 0.997355,-2.302701 0.6549425,-0.494957 1.4571705,-0.742074 2.4070875,-0.742074 z m -0.149861,8.8640575 c 0.369968,0 0.665236,0.109715 0.885217,0.329696 0.219981,0.219981 0.329696,0.49255 0.329696,0.817521 0,0.324972 -0.109715,0.59754 -0.329696,0.817521 -0.219981,0.219981 -0.515249,0.330213 -0.885217,0.330213 -0.369968,0 -0.66472,-0.110232 -0.884701,-0.330213 -0.214981,-0.219981 -0.322461,-0.492549 -0.322461,-0.817521 0,-0.324971 0.10748,-0.59754 0.322461,-0.817521 0.219981,-0.219981 0.514733,-0.329696 0.884701,-0.329696 z"}),"IndeterminateCheckBox"),f=e=>{let{name:t,tribool:n,setTribool:s}=e,i=!0===n,o=null===n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{name:t,type:"hidden",value:o?"indeterminate":i?"on":""}),(0,r.jsx)(d.Z,{color:o?"maybe":i?"primary":"error",checked:i,indeterminate:o,onChange:function(e){o?s(!1):i?s(null):s(!0)},icon:(0,r.jsx)(u,{}),checkedIcon:(0,r.jsx)(p,{}),indeterminateIcon:(0,r.jsx)(m,{})})]})};var x=n(807),j=n(2153),g=n(9717),v=n(1146),b=n(2184);let w=e=>{let{pollId:t,config:n,votes:i,titleIsHtml:o=!1,pretend:l=!1}=e,[a,d]=(0,s.useState)([]),[h,u]=(0,s.useState)(""),p=a;if(a.length>n.options.length)p=a.slice(0,n.options.length);else if(a.length<n.options.length){let e=n.options.slice(a.length).map(e=>!1);p=a.concat(e)}console.assert(p.length===n.options.length);let m=n.options.map((e,t)=>i.reduce((e,n)=>{let[r,s]=n;return e+ +!!s[t]},+!!p[t])),w=n.options.map((e,t)=>i.reduce((e,n)=>{let[r,s]=n;return e+ +(!1!==s[t])},+!![!0,null].includes(p[t]))),y=n.options.map((e,t)=>w[t]>m[t]?`${m[t]}\u{2013}${w[t]}`:m[t]),O=e=>t=>{let n=p.slice();n[e]=t,d(n)};return(0,r.jsxs)(j.Z,{className:`poll ${l?"preview":""}`,children:[l&&(0,r.jsx)(v.Z,{title:"Preview"}),(0,r.jsxs)(g.Z,{children:[(0,r.jsx)("h2",{dangerouslySetInnerHTML:{__html:o?n.title:c(n.title)},className:"question"}),(0,r.jsxs)("form",{method:"POST",action:`vote/${t}`,children:[(0,r.jsx)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:window.DJANGO_CSRF_TOKEN}),(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{}),n.options.map((e,t)=>(0,r.jsx)("td",{className:"vote",children:e},t)),(0,r.jsx)("td",{})]})}),(0,r.jsxs)("tbody",{children:[i.map((e,t)=>{let[n,s]=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{dangerouslySetInnerHTML:{__html:n},className:"person"}),s.map((e,t)=>(0,r.jsx)("td",{className:`vote ${e?"votedYes":null===e?"votedMaybe":"votedNo"}`,children:e?"✔":null===e?(0,r.jsx)("b",{children:"?"}):"✘"},t)),(0,r.jsx)("td",{})]},t)}),(0,r.jsxs)("tr",{className:"userVote",children:[(0,r.jsx)("td",{children:(0,r.jsx)(b.Z,{name:"voterName",placeholder:"Your name",variant:"standard",autoFocus:!l,value:h,onChange:e=>u(e.target.value),error:!l&&!h.trim(),className:"voterName"})}),p.map((e,t)=>(0,r.jsx)("td",{className:`vote ${e?"votedYes":null===e?"votedMaybe":"votedNo"}`,children:(0,r.jsx)(f,{name:`option${t}`,tribool:e,setTribool:O(t)})},t)),(0,r.jsxs)("td",{children:[" ",(0,r.jsx)(x.Z,{variant:"contained",disabled:l||!h.trim(),type:"submit",className:"submitVote",children:"SAVE"})]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{}),y.map((e,t)=>(0,r.jsx)("td",{className:`vote ${e?"sumNonZero":""}`,children:e},t)),(0,r.jsx)("td",{})]})]})]})]})]})]})},y=["Dmitri","Jule","Vered","Matthieu"],O={},N=0,Z=0,_=(e,t)=>{let n=`${e}@${t}`,r=O[n];if(void 0===r){let e=4*y.length/2;if(N>e&&0==Z)r=null;else{let e=Math.random();r=e>.95?null:e>.475}N+=1,null===r&&(Z+=1),O[n]=r}return r},k=e=>{let{config:t}=e,n=y.map((e,n)=>[e,t.options.map((e,t)=>_(n,t))]);return(0,r.jsx)(w,{config:t,votes:n,pretend:!0})},S=(e,t)=>{let n=Math.min(e.length,t.length),r=0;for(;r<n&&e[r]==t[r];r++);return e.substring(0,r)},A=e=>e.substring(0,e.length-e.trimStart().length);var C=n(632),E=n(6370);let P=(e=>{let t=e.split("\n"),n=t.reduce((e,t)=>S(A(t)+e,e),A(t[0]));return t.map(e=>e.substring(n.length)).join("\n")})(`\
  title: Which fruit do _**you**_ like?

  options:
    - Apple
    - Banana
    - Orange
    - Papaya

  lifetime: month
`);class M extends Error{constructor(e){super(e),this.name="InvalidConfigError",Object.setPrototypeOf(this,M.prototype)}}let T=e=>{let t=(0,E.Qc)(e);if(void 0!==t.equal_width&&"boolean"!=typeof t.equal_width)throw new M("Attribute 'equal_width' is invalid, must be boolean.");if(!["month","week",void 0].includes(t.lifetime))throw new M("Attribute 'lifetime' is invalid, must be 'month' or 'week'.");if(void 0===t.options)throw new M("Attribute 'options' is missing.");if(!Array.isArray(t.options))throw new M("Attribute 'options' is not a list.");if(!t.options.every(e=>"string"==typeof e))throw new M("Attribute 'options' is not a list of strings.");if(void 0===t.title)throw new M("Attribute 'title' is missing.");if("string"!=typeof t.title)throw new M("Attribute 'title' is not a string.");return t},$=T(P),I=[P,!0,$],z=e=>{let{configState:t}=e,[[n,s,i],o]=t;return(0,r.jsx)("div",{className:"setup",children:(0,r.jsx)("form",{action:"create",method:"POST",children:(0,r.jsxs)(j.Z,{children:[(0,r.jsx)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:window.DJANGO_CSRF_TOKEN}),(0,r.jsx)(g.Z,{children:(0,r.jsx)(b.Z,{name:"config",label:"Setup (YAML or JSON)",multiline:!0,value:n,variant:"standard",onChange:e=>{let t=e.target.value,n=!1,r=null;try{r=T(t),n=!0}catch(e){console.log("[DEBUG]","Config YAML/JSON failed to validate with error:",e.message),r=i}o([t,n,r])},className:`monospace-text ${s?"valid":"invalid"}`,autoFocus:!0,error:!s})}),(0,r.jsxs)(C.Z,{className:"setupButtons",sx:{justifyContent:"flex-end"},children:[(0,r.jsx)(x.Z,{variant:"text",onClick:e=>{o(I)},color:"inherit",children:"RESET"}),(0,r.jsx)(x.Z,{type:"submit",variant:"contained",disabled:!s,children:"CREATE"})]})]})})})};var V=n(8530),B=n(9814),H=n(7683),R=n(3797),F=n(3681);let L=e=>new Promise(t=>setTimeout(t,e)),q=async(e,t)=>{let n=`data/${e}`;try{let e=await fetch(n);if(!e.ok)throw Error(`HTTP request to '${n}' failed with status ${e.status}.`);let r=await e.json();t(r)}catch(e){console.error("ERROR:",e.message)}},G=async(e,t)=>{for(;;)document.hidden||await q(e,t),await L(1e3)},J=window.location.pathname.includes("/poll/")?/[0-9a-fA-F]{64}/.exec(window.location.pathname)[0]:null;J&&(document.title="jawanndenn: Vote!");let Y=(0,V.Z)({palette:{primary:{main:H.Z["400"]}}}),D=(0,V.Z)(Y,{palette:{maybe:Y.palette.augmentColor({color:{main:R.Z["700"]},name:"maybe"})}}),K=e=>{let{pollId:t}=e,[n,i]=(0,s.useState)(null);return n?(0,r.jsx)(F.Z,{container:!0,spacing:2,sx:{justifyContent:"safe center",alignItems:"flow-start"},children:(0,r.jsx)(F.Z,{size:{xs:12,sm:12,md:"auto",lg:"auto",xl:"auto"},children:(0,r.jsx)("div",{className:"live",children:(0,r.jsx)(w,{pollId:t,config:n.config,votes:n.votes,titleIsHtml:!0})})})}):(G(t,i),(0,r.jsx)(r.Fragment,{}))},U=()=>{let e=(0,s.useState)(I),t=e[0][2];return(0,r.jsxs)(F.Z,{container:!0,spacing:2,sx:{justifyContent:"safe center"},children:[(0,r.jsx)(F.Z,{size:{xs:12,sm:12,md:4,lg:3,xl:3},children:(0,r.jsx)(z,{configState:e})}),(0,r.jsx)(F.Z,{size:{xs:12,sm:12,md:"auto",lg:"auto",xl:"auto"},children:(0,r.jsx)(k,{config:t})})]})},W=document.getElementById("root");W&&i.createRoot(W).render((0,r.jsx)(s.StrictMode,{children:(0,r.jsx)(()=>(0,r.jsxs)(B.Z,{theme:D,children:[(0,r.jsx)("div",{className:"stage",children:J?(0,r.jsx)(K,{pollId:J}):(0,r.jsx)(U,{})}),(0,r.jsx)(o,{})]}),{})}))}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,s){if(1&s&&(r=this(r)),8&s||"object"==typeof r&&r&&(4&s&&r.__esModule||16&s&&"function"==typeof r.then))return r;var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var l=2&s&&r;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>{o[e]=()=>r[e]});return o.default=()=>r,n.d(i,o),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=[];n.O=(t,r,s,i)=>{if(r){i=i||0;for(var o=e.length;o>0&&e[o-1][2]>i;o--)e[o]=e[o-1];e[o]=[r,s,i];return}for(var l=1/0,o=0;o<e.length;o++){for(var[r,s,i]=e[o],a=!0,c=0;c<r.length;c++)(!1&i||l>=i)&&Object.keys(n.O).every(e=>n.O[e](r[c]))?r.splice(c--,1):(a=!1,i<l&&(l=i));if(a){e.splice(o--,1);var d=s();void 0!==d&&(t=d)}}return t}})(),n.rv=()=>"1.3.12",(()=>{var e={980:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var s,i,[o,l,a]=r,c=0;if(o.some(t=>0!==e[t])){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(a)var d=a(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(d)},r=self.webpackChunkfrontend=self.webpackChunkfrontend||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.ruid="bundler=rspack@1.3.12";var r=n.O(void 0,["361","90"],function(){return n(6870)});r=n.O(r)})();