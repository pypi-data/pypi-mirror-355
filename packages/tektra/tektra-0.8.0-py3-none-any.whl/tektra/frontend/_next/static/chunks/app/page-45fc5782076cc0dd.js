(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{874:(e,s,t)=>{"use strict";t.d(s,{default:()=>Q});var a=t(5155),n=t(2115),r=t(2596),i=t(9688);function o(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,i.QP)((0,r.$)(s))}let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:s,className:o("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});c.displayName="Card";let l=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:s,className:o("flex flex-col space-y-1.5 p-6",t),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("h3",{ref:s,className:o("text-2xl font-semibold leading-none tracking-tight",t),...n})});d.displayName="CardTitle",n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("p",{ref:s,className:o("text-sm text-muted-foreground",t),...n})}).displayName="CardDescription";let m=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:s,className:o("p-6 pt-0",t),...n})});m.displayName="CardContent";let u=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:s,className:o("flex items-center p-6 pt-0",t),...n})});u.displayName="CardFooter";let h=(0,t(2085).F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),x=n.forwardRef((e,s)=>{let{className:t,variant:n,size:r,...i}=e;return(0,a.jsx)("button",{className:o(h({variant:n,size:r,className:t})),ref:s,...i})});x.displayName="Button";var v=t(5657),p=t(1007),g=t(9397),f=t(4355),j=t(9588),y=t(381);let N=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("textarea",{className:o("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n})});N.displayName="Textarea";var b=t(7550),w=t(2432),S=t(4357),C=t(3904),A=t(4020),k=t(1951),_=t(2486);let T=t(9509).env.NEXT_PUBLIC_API_URL||"http://localhost:8000";class R{async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let t="".concat(this.baseUrl).concat(e),a=await fetch(t,{headers:{"Content-Type":"application/json",...s.headers},...s});return{data:await a.json(),status:a.status}}catch(e){return{error:e instanceof Error?e.message:"Unknown error",status:500}}}async sendChatMessage(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return this.request("/api/v1/ai/chat",{method:"POST",body:JSON.stringify({message:e,model:s,stream:!1})})}async getModels(){return this.request("/api/v1/ai/models")}async loadModel(e){return this.request("/api/v1/ai/models/".concat(e,"/load"),{method:"POST"})}async unloadModel(e){return this.request("/api/v1/ai/models/".concat(e),{method:"DELETE"})}async startRecording(){return this.request("/api/v1/audio/record/start",{method:"POST"})}async stopRecording(){return this.request("/api/v1/audio/record/stop",{method:"POST"})}async transcribeAudio(e){let s=new FormData;return s.append("audio_file",e),this.request("/api/v1/audio/transcribe",{method:"POST",body:s,headers:{}})}async synthesizeSpeech(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return this.request("/api/v1/audio/synthesize",{method:"POST",body:JSON.stringify({text:e,voice:s,speed:1,language:"en"})})}async getVoices(){return this.request("/api/v1/audio/voices")}async getAvatarStatus(){return this.request("/api/v1/avatar/status")}async setAvatarExpression(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.request("/api/v1/avatar/expression",{method:"POST",body:JSON.stringify({expression:e,intensity:s,duration:2})})}async triggerAvatarGesture(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.request("/api/v1/avatar/gesture",{method:"POST",body:JSON.stringify({gesture:e,speed:s,repeat:1})})}async makeAvatarSpeak(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"neutral";return this.request("/api/v1/avatar/speak",{method:"POST",body:JSON.stringify({text:e,lip_sync:!0,expression:s})})}async getCameraStatus(){return this.request("/api/v1/camera/status")}async captureImage(){return this.request("/api/v1/camera/capture",{method:"POST"})}async analyzeImage(e){let s=new FormData;return s.append("image_file",e),this.request("/api/v1/camera/analyze",{method:"POST",body:s,headers:{}})}async getRobots(){return this.request("/api/v1/robots")}async sendRobotCommand(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("/api/v1/robots/".concat(e,"/command"),{method:"POST",body:JSON.stringify({action:s,parameters:t,priority:"normal"})})}async getRobotStatus(e){return this.request("/api/v1/robots/".concat(e,"/status"))}async emergencyStop(e){return this.request("/api/v1/robots/".concat(e,"/emergency"),{method:"POST"})}async getConversations(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.request("/api/v1/conversations?limit=".concat(e,"&offset=").concat(s))}async createConversation(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"phi-3-mini";return this.request("/api/v1/conversations",{method:"POST",body:JSON.stringify({title:e,model_name:s})})}async getConversation(e){return this.request("/api/v1/conversations/".concat(e))}async addMessageToConversation(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"user",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text";return this.request("/api/v1/conversations/".concat(e,"/messages"),{method:"POST",body:JSON.stringify({content:s,role:t,message_type:a})})}async getConversationMessages(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=new URLSearchParams;return s&&a.set("limit",s.toString()),a.set("include_system",t.toString()),this.request("/api/v1/conversations/".concat(e,"/messages?").concat(a))}async updateConversationTitle(e,s){return this.request("/api/v1/conversations/".concat(e,"/title"),{method:"PUT",body:JSON.stringify({title:s})})}async deleteConversation(e){return this.request("/api/v1/conversations/".concat(e),{method:"DELETE"})}async searchConversations(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return this.request("/api/v1/conversations/search/".concat(encodeURIComponent(e),"?limit=").concat(s))}async getConversationStats(e){return this.request("/api/v1/conversations/".concat(e,"/stats"))}async getConversationContext(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return this.request("/api/v1/conversations/".concat(e,"/context?max_messages=").concat(s))}async healthCheck(){return this.request("/health")}constructor(e=T){this.baseUrl=e}}let P=new R;var O=t(9509);class q{connect(){return new Promise((e,s)=>{try{this.ws=new WebSocket(this.url),this.ws.onopen=()=>{console.log("WebSocket connected to:",this.url),this.reconnectAttempts=0,e()},this.ws.onmessage=e=>{try{let s=JSON.parse(e.data);this.handleMessage(s)}catch(e){console.error("Failed to parse WebSocket message:",e)}},this.ws.onclose=()=>{console.log("WebSocket disconnected"),this.handleReconnect()},this.ws.onerror=e=>{console.error("WebSocket error:",e),s(e)}}catch(e){s(e)}})}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}send(e){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(e)):console.warn("WebSocket not connected, cannot send message:",e)}on(e,s){this.eventHandlers.has(e)||this.eventHandlers.set(e,[]),this.eventHandlers.get(e).push(s)}off(e,s){let t=this.eventHandlers.get(e);if(t){let e=t.indexOf(s);e>-1&&t.splice(e,1)}}handleMessage(e){let s=this.eventHandlers.get(e.type);s&&s.forEach(s=>s(e));let t=this.eventHandlers.get("message");t&&t.forEach(s=>s(e))}handleReconnect(){this.reconnectAttempts<this.maxReconnectAttempts?(this.reconnectAttempts++,console.log("Attempting to reconnect... (".concat(this.reconnectAttempts,"/").concat(this.maxReconnectAttempts,")")),setTimeout(()=>{this.connect().catch(e=>{console.error("Reconnection failed:",e)})},this.reconnectInterval*this.reconnectAttempts)):console.error("Max reconnection attempts reached")}get isConnected(){var e;return(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN}constructor(e){this.ws=null,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectInterval=1e3,this.eventHandlers=new Map,this.url=e}}let E=O.env.NEXT_PUBLIC_WS_URL||"ws://localhost:8000",F=new q("".concat(E,"/ws/chat/user123"));new q("".concat(E,"/ws/audio/user123")),new q("".concat(E,"/ws/camera"));let I=new q("".concat(E,"/ws/robot/robot_001")),z=n.forwardRef((e,s)=>{let{className:t,type:n,...r}=e;return(0,a.jsx)("input",{type:n,className:o("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r})});z.displayName="Input";var D=t(1497),M=t(4616),U=t(7924),J=t(4186),L=t(4940),W=t(2525);function B(e){let{currentConversation:s,onConversationSelect:t,onNewConversation:r}=e,[i,o]=(0,n.useState)([]),[u,h]=(0,n.useState)(""),[g,f]=(0,n.useState)(!1),[j,y]=(0,n.useState)(null),[N,b]=(0,n.useState)("");(0,n.useEffect)(()=>{w()},[]);let w=async()=>{f(!0);try{let e=await P.getConversations();e.data&&o(e.data)}catch(e){console.error("Failed to load conversations:",e)}finally{f(!1)}},S=async e=>{if(h(e),!e.trim())return void w();try{let s=await P.searchConversations(e);s.data&&o(s.data)}catch(e){console.error("Failed to search conversations:",e)}},C=async e=>{try{let s=await P.getConversation(e.id);s.data&&t(s.data)}catch(e){console.error("Failed to load conversation:",e)}},A=async(e,t)=>{if(t.stopPropagation(),confirm("Are you sure you want to delete this conversation?"))try{await P.deleteConversation(e),o(s=>s.filter(s=>s.id!==e)),s===e&&r()}catch(e){console.error("Failed to delete conversation:",e)}},k=async(e,s)=>{if(s.trim())try{await P.updateConversationTitle(e,s),o(t=>t.map(t=>t.id===e?{...t,title:s}:t)),y(null),b("")}catch(e){console.error("Failed to update conversation title:",e)}},_=(e,s)=>{s.stopPropagation(),y(e.id),b(e.title)},T=e=>{let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/864e5);return 0===t?s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):1===t?"Yesterday":t<7?"".concat(t," days ago"):s.toLocaleDateString()},R=e=>e?1===e?"1 message":"".concat(e," messages"):"";return(0,a.jsxs)(c,{className:"h-full flex flex-col",children:[(0,a.jsxs)(l,{className:"pb-3",children:[(0,a.jsxs)(d,{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"flex items-center gap-2",children:[(0,a.jsx)(D.A,{className:"h-5 w-5"}),"Conversations"]}),(0,a.jsx)(x,{size:"sm",onClick:r,className:"h-8 w-8 p-0",children:(0,a.jsx)(M.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(U.A,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(z,{placeholder:"Search conversations...",value:u,onChange:e=>S(e.target.value),className:"pl-9"})]})]}),(0,a.jsx)(m,{className:"flex-1 overflow-y-auto space-y-2 px-3",children:g?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading conversations..."})}):0===i.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)(D.A,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:u?"No conversations found":"No conversations yet"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:u?"Try a different search term":"Start a new conversation to get started"})]}):i.map(e=>(0,a.jsx)("div",{className:"group cursor-pointer rounded-lg border p-3 hover:bg-accent transition-colors ".concat(s===e.id?"bg-accent border-primary":""),onClick:()=>C(e),children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[j===e.id?(0,a.jsx)(z,{value:N,onChange:e=>b(e.target.value),onBlur:()=>k(e.id,N),onKeyPress:s=>{"Enter"===s.key?k(e.id,N):"Escape"===s.key&&(y(null),b(""))},className:"h-6 text-sm",autoFocus:!0,onClick:e=>e.stopPropagation()}):(0,a.jsx)("h4",{className:"font-medium text-sm truncate",children:e.title}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-muted-foreground",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(J.A,{className:"h-3 w-3"}),T(e.updated_at)]}),void 0!==e.message_count&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(p.A,{className:"h-3 w-3"}),(0,a.jsx)(v.A,{className:"h-3 w-3 -ml-1"})]}),R(e.message_count)]})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["Model: ",e.model_name]})]}),(0,a.jsxs)("div",{className:"flex opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)(x,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:s=>_(e,s),children:(0,a.jsx)(L.A,{className:"h-3 w-3"})}),(0,a.jsx)(x,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-destructive hover:text-destructive",onClick:s=>A(e.id,s),children:(0,a.jsx)(W.A,{className:"h-3 w-3"})})]})]})},e.id))})]})}function H(e){let{onNavigate:s}=e,[t,r]=(0,n.useState)([]),[i,o]=(0,n.useState)(""),[h,T]=(0,n.useState)(!1),[R,O]=(0,n.useState)(!1),[q,E]=(0,n.useState)("phi-3-mini"),[I,z]=(0,n.useState)(!1),[D,M]=(0,n.useState)(null),[U,J]=(0,n.useState)(null),[L,W]=(0,n.useState)(!0),[H]=(0,n.useState)("1"),G=(0,n.useRef)(null);(0,n.useEffect)(()=>((async()=>{try{await F.connect(),z(!0)}catch(e){console.error("WebSocket connection failed:",e),z(!1)}})(),F.on("conversation_created",e=>{let s=e.data;s.conversation_id&&(M(s.conversation_id),console.log("New conversation created: ".concat(s.conversation_id)))}),F.on("ai_response_start",e=>{let s=e.data;r(e=>[...e,{id:Date.now().toString(),role:"assistant",content:"",timestamp:new Date,conversationId:s.conversation_id}])}),F.on("ai_response_token",e=>{let s=e.data;r(e=>{let t=[...e],a=t[t.length-1];return a&&"assistant"===a.role&&(a.content+=s.token||""),t})}),F.on("ai_response_complete",e=>{T(!1);let s=e.data;console.log("AI response completed. Tokens used: ".concat(s.tokens_used,", Model: ").concat(s.model))}),F.on("ai_response_error",e=>{T(!1);let s=e.data;r(e=>[...e,{id:Date.now().toString(),role:"assistant",content:"Error: ".concat(s.error||"Unknown error occurred"),timestamp:new Date}])}),()=>{F.disconnect()}),[H]),(0,n.useEffect)(()=>{var e;null==(e=G.current)||e.scrollIntoView({behavior:"smooth"})},[t]);let K=async e=>{if(!e.trim())return;let s={id:Date.now().toString(),role:"user",content:e,timestamp:new Date,conversationId:D||void 0};r(e=>[...e,s]),o(""),T(!0);try{if(I)F.send({type:"chat",data:{message:e,model:q,conversation_id:D}});else{let s=D;if(!s){let e=await P.createConversation(void 0,q);e.data&&(s=e.data.id,M(s))}s&&await P.addMessageToConversation(s,e,"user");let a=await P.sendChatMessage(e,q);if(a.data&&(r(e=>{var t;return[...e,{id:(Date.now()+1).toString(),role:"assistant",content:(null==(t=a.data)?void 0:t.response)||"No response",timestamp:new Date,conversationId:null!=s?s:void 0}]}),s)){var t;await P.addMessageToConversation(s,(null==(t=a.data)?void 0:t.response)||"No response","assistant")}T(!1)}}catch(e){console.error("Failed to send message:",e),T(!1)}},V=async()=>{if(R){O(!1);try{await P.stopRecording()}catch(e){console.error("Failed to stop recording:",e)}}else{O(!0);try{await P.startRecording()}catch(e){console.error("Failed to start recording:",e),O(!1)}}},X=e=>{navigator.clipboard.writeText(e)},Y=async e=>{if(e<1)return;let s=t[e-1];"user"===s.role&&(r(s=>s.slice(0,e)),await K(s.content))},Q=e=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(0,a.jsxs)("div",{className:"flex h-screen bg-background",children:[L&&(0,a.jsx)("div",{className:"w-80 border-r",children:(0,a.jsx)(B,{currentConversation:D,onConversationSelect:e=>{J(e),M(e.id),r(e.messages.map(s=>({id:s.id.toString(),role:s.role,content:s.content,timestamp:new Date(s.created_at),conversationId:e.id,metadata:s.metadata}))),E(e.model_name)},onNewConversation:()=>{r([]),M(null),J(null)}})}),(0,a.jsx)("div",{className:"flex-1 flex flex-col",children:(0,a.jsxs)(c,{className:"h-full flex flex-col border-0 rounded-none",children:[(0,a.jsxs)(l,{className:"border-b",children:[(0,a.jsxs)(d,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[s&&(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>s("dashboard"),children:(0,a.jsx)(b.A,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>W(!L),children:(0,a.jsx)(w.A,{className:"h-4 w-4"})}),(0,a.jsx)("span",{children:U?U.title:"AI Chat Assistant"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>s("avatar"),title:"Avatar Control",children:(0,a.jsx)(p.A,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>s("robot"),title:"Robot Control",children:(0,a.jsx)(g.A,{className:"h-4 w-4"})}),(0,a.jsx)(x,{variant:"ghost",size:"sm",onClick:()=>s("camera"),title:"Camera Control",children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(I?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:I?"Connected":"Disconnected"}),(0,a.jsx)(x,{variant:"ghost",size:"sm",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("select",{value:q,onChange:e=>E(e.target.value),className:"text-sm border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"phi-3-mini",children:"Phi-3 Mini"}),(0,a.jsx)("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo"}),(0,a.jsx)("option",{value:"llama-2-7b-chat",children:"Llama 2 7B Chat"})]}),U&&(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:[U.messages.length," messages"]})]})]}),(0,a.jsxs)(m,{className:"flex-1 overflow-y-auto space-y-4 p-4",children:[0===t.length&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[(0,a.jsx)(v.A,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Start a conversation"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Ask me anything! I'm here to help with your questions and tasks."})]}),t.map((e,s)=>(0,a.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"group max-w-[80%] rounded-lg px-4 py-3 ".concat("user"===e.role?"bg-primary text-primary-foreground":"bg-muted"),children:[(0,a.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:["user"===e.role?(0,a.jsx)(p.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}):(0,a.jsx)(v.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:e.content})}),(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[(0,a.jsx)(x,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>X(e.content),children:(0,a.jsx)(S.A,{className:"h-3 w-3"})}),"assistant"===e.role&&(0,a.jsx)(x,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>Y(s),children:(0,a.jsx)(C.A,{className:"h-3 w-3"})}),(0,a.jsx)(x,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",children:(0,a.jsx)(A.A,{className:"h-3 w-3"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-xs opacity-70",children:Q(e.timestamp)}),e.conversationId&&(0,a.jsxs)("p",{className:"text-xs opacity-50",children:["Conv #",e.conversationId]})]})]})},e.id)),h&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-muted rounded-lg px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(v.A,{className:"h-4 w-4"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce"}),(0,a.jsx)("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),(0,a.jsx)("span",{className:"text-sm",children:"AI is thinking..."})]})]})})}),(0,a.jsx)("div",{ref:G})]}),(0,a.jsx)(u,{className:"border-t p-4",children:(0,a.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,a.jsx)(x,{variant:R?"destructive":"outline",size:"icon",onClick:V,children:R?(0,a.jsx)(k.A,{className:"h-4 w-4"}):(0,a.jsx)(j.A,{className:"h-4 w-4"})}),(0,a.jsx)(N,{value:i,onChange:e=>o(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),K(i))},placeholder:"Type your message...",className:"flex-1 min-h-0 resize-none",rows:1}),(0,a.jsx)(x,{onClick:()=>K(i),disabled:!i.trim()||h,children:(0,a.jsx)(_.A,{className:"h-4 w-4"})})]})})]})})]})}var G=t(5690),K=t(133);function V(){let[e,s]=(0,n.useState)(null),[t,r]=(0,n.useState)("neutral"),[i,o]=(0,n.useState)("wave"),[u,h]=(0,n.useState)(""),[v,p]=(0,n.useState)(!1);(0,n.useEffect)(()=>{g()},[]);let g=async()=>{try{let e=await P.getAvatarStatus();e.data&&s(e.data)}catch(e){console.error("Failed to load avatar status:",e)}},f=async()=>{if(t){p(!0);try{var e;(null==(e=(await P.setAvatarExpression(t,1)).data)?void 0:e.status)==="success"&&g()}catch(e){console.error("Failed to set expression:",e)}finally{p(!1)}}},j=async()=>{if(i){p(!0);try{var e;(null==(e=(await P.triggerAvatarGesture(i,1)).data)?void 0:e.status)==="success"&&g()}catch(e){console.error("Failed to trigger gesture:",e)}finally{p(!1)}}},y=async()=>{if(u.trim()){p(!0);try{var e;(null==(e=(await P.makeAvatarSpeak(u,t)).data)?void 0:e.status)==="success"&&(g(),h(""))}catch(e){console.error("Failed to make avatar speak:",e)}finally{p(!1)}}},N=async()=>{p(!0);try{await P.setAvatarExpression("neutral",1),await g()}catch(e){console.error("Failed to reset avatar:",e)}finally{p(!1)}};return(0,a.jsxs)(c,{children:[(0,a.jsx)(l,{children:(0,a.jsxs)(d,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Avatar Control"}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat((null==e?void 0:e.active)?"bg-green-500":"bg-gray-400")})]})}),(0,a.jsxs)(m,{className:"space-y-6",children:[e&&(0,a.jsx)("div",{className:"bg-muted p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Expression:"})," ",e.current_expression]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Gesture:"})," ",e.current_gesture]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Speaking:"})," ",e.speaking?"Yes":"No"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Position:"})," X:".concat(e.position.x," Y:").concat(e.position.y," Z:").concat(e.position.z)]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Expression"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("select",{value:t,onChange:e=>r(e.target.value),className:"flex-1 border rounded px-3 py-2",children:["neutral","happy","sad","angry","surprised","confused","thinking","excited","calm"].map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsx)(x,{onClick:f,disabled:v,children:(0,a.jsx)(G.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Gesture"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("select",{value:i,onChange:e=>o(e.target.value),className:"flex-1 border rounded px-3 py-2",children:["wave","nod","shake_head","point","thumbs_up","shrug","clap","peace_sign","thinking_pose"].map(e=>(0,a.jsx)("option",{value:e,children:e.replace("_"," ").charAt(0).toUpperCase()+e.replace("_"," ").slice(1)},e))}),(0,a.jsx)(x,{onClick:j,disabled:v,children:(0,a.jsx)(G.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Speech"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(z,{value:u,onChange:e=>h(e.target.value),placeholder:"Enter text for avatar to speak...",className:"flex-1"}),(0,a.jsx)(x,{onClick:y,disabled:v||!u.trim(),children:(0,a.jsx)(G.A,{className:"h-4 w-4"})})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)(x,{onClick:N,variant:"outline",disabled:v,children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2"}),"Reset Avatar"]})})]})]})}var X=t(1243);function Y(){let[e,s]=(0,n.useState)([]),[t,r]=(0,n.useState)(""),[i,o]=(0,n.useState)("move_to"),[u,h]=(0,n.useState)(""),[v,p]=(0,n.useState)(!1),[g,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>(j(),I.connect().then(()=>{f(!0)}).catch(console.error),I.on("robot_status",e=>{let t=e.data;s(e=>e.map(e=>e.id===t.robot_id?{...e,status:t.status||e.status,position:t.position||e.position}:e))}),()=>{I.disconnect()}),[]);let j=async()=>{try{let e=await P.getRobots();e.data&&Array.isArray(e.data)&&(s(e.data),e.data.length>0&&r(e.data[0].id))}catch(e){console.error("Failed to load robots:",e)}},y=async()=>{if(t&&i){p(!0);try{let s={};if(u.trim())try{s=JSON.parse(u)}catch(e){s={value:u}}if(g)I.send({type:"command",data:{command:i,parameters:s}});else{var e;(null==(e=(await P.sendRobotCommand(t,i,s)).data)?void 0:e.status)==="success"&&j()}}catch(e){console.error("Failed to send command:",e)}finally{p(!1)}}},N=async e=>{try{await P.emergencyStop(e),j()}catch(e){console.error("Failed to emergency stop:",e)}},b=e=>{let s=Math.floor(e/3600),t=Math.floor(e%3600/60);return"".concat(s,"h ").concat(t,"m")},w=e=>{switch(e){case"connected":case"idle":return"bg-green-500";case"moving":case"executing":return"bg-blue-500";case"error":return"bg-red-500";case"disconnected":return"bg-gray-400";default:return"bg-yellow-500"}};return(0,a.jsxs)(c,{children:[(0,a.jsx)(l,{children:(0,a.jsxs)(d,{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Robot Control"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(g?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:g?"Connected":"Disconnected"})]})]})}),(0,a.jsxs)(m,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Select Robot"}),(0,a.jsx)("select",{value:t,onChange:e=>r(e.target.value),className:"w-full border rounded px-3 py-2",children:e.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," (",e.id,")"]},e.id))})]}),t&&e.find(e=>e.id===t)&&(0,a.jsx)("div",{className:"bg-muted p-4 rounded-lg",children:(()=>{let s=e.find(e=>e.id===t);return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:s.name}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(w(s.status))}),(0,a.jsx)("span",{className:"text-sm",children:s.status})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Battery:"})," ",s.battery,"%"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Uptime:"})," ",b(s.uptime)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Last Command:"})," ",s.last_command]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Position:"}),Object.entries(s.position).map(e=>{let[s,t]=e;return" ".concat(s.toUpperCase(),":").concat(t)}).join(",")]})]})]})})()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Send Command"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full border rounded px-3 py-2",children:["move_to","pick_up","place","rotate","stop","home","navigate","turn","open_gripper","close_gripper"].map(e=>(0,a.jsx)("option",{value:e,children:e.replace("_"," ").charAt(0).toUpperCase()+e.replace("_"," ").slice(1)},e))}),(0,a.jsx)(z,{value:u,onChange:e=>h(e.target.value),placeholder:"Parameters (JSON or simple value)"}),(0,a.jsxs)(x,{onClick:y,disabled:v||!t,className:"w-full",children:[(0,a.jsx)(G.A,{className:"h-4 w-4 mr-2"}),"Send Command"]})]})]}),t&&(0,a.jsx)("div",{className:"border-t pt-4",children:(0,a.jsxs)(x,{onClick:()=>N(t),variant:"destructive",className:"w-full",children:[(0,a.jsx)(X.A,{className:"h-4 w-4 mr-2"}),"Emergency Stop"]})}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)(x,{onClick:j,variant:"outline",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Refresh Status"]})})]})]})}function Q(){let[e,s]=(0,n.useState)("chat"),[t,r]=(0,n.useState)({backend:!1,models:0,robots:0,avatar:!1,camera:!1,audio:!1});(0,n.useEffect)(()=>{i();let e=setInterval(i,3e4);return()=>clearInterval(e)},[]);let i=async()=>{try{var e,s;let t=await P.healthCheck(),a=200===t.status,n=await P.getModels(),i=Array.isArray(n.data)?n.data.length:0,o=await P.getRobots(),c=Array.isArray(o.data)?o.data.length:0,l=(null==(e=(await P.getAvatarStatus()).data)?void 0:e.active)||!1,d=(null==(s=(await P.getCameraStatus()).data)?void 0:s.connected)||!1;r({backend:a,models:i,robots:c,avatar:l,camera:d,audio:!0})}catch(e){console.error("Failed to check system status:",e),r(e=>({...e,backend:!1}))}},o=[{id:"chat",label:"Chat",icon:v.A},{id:"avatar",label:"Avatar",icon:p.A},{id:"robot",label:"Robot",icon:g.A},{id:"camera",label:"Camera",icon:f.A},{id:"audio",label:"Audio",icon:j.A}];return"chat"===e?(0,a.jsx)(H,{onNavigate:s}):(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)("header",{className:"border-b",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Tektra AI Assistant"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(t.backend?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{children:"Backend"})]}),(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:[t.models," Models | ",t.robots," Robots"]}),(0,a.jsx)(x,{variant:"outline",size:"sm",children:(0,a.jsx)(y.A,{className:"h-4 w-4"})})]})]})})}),(0,a.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-1",children:[(0,a.jsxs)(c,{children:[(0,a.jsx)(l,{children:(0,a.jsx)(d,{children:"Navigation"})}),(0,a.jsx)(m,{className:"space-y-2",children:o.map(t=>{let n=t.icon;return(0,a.jsxs)(x,{variant:e===t.id?"default":"ghost",className:"w-full justify-start",onClick:()=>s(t.id),children:[(0,a.jsx)(n,{className:"h-4 w-4 mr-2"}),t.label]},t.id)})})]}),(0,a.jsxs)(c,{className:"mt-4",children:[(0,a.jsx)(l,{children:(0,a.jsx)(d,{children:"System Status"})}),(0,a.jsxs)(m,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm",children:"Backend"}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t.backend?"bg-green-500":"bg-red-500")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm",children:"Avatar"}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t.avatar?"bg-green-500":"bg-gray-400")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm",children:"Camera"}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t.camera?"bg-green-500":"bg-gray-400")})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm",children:"Audio"}),(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(t.audio?"bg-green-500":"bg-gray-400")})]}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:[t.models," AI Models Available",(0,a.jsx)("br",{}),t.robots," Robots Connected"]})]})]})]}),(0,a.jsx)("div",{className:"lg:col-span-3",children:(()=>{switch(e){case"avatar":return(0,a.jsx)(V,{});case"robot":return(0,a.jsx)(Y,{});case"camera":return(0,a.jsxs)(c,{children:[(0,a.jsx)(l,{children:(0,a.jsx)(d,{children:"Camera Control"})}),(0,a.jsx)(m,{children:(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:"Camera interface coming in Week 2..."})})]});case"audio":return(0,a.jsxs)(c,{children:[(0,a.jsx)(l,{children:(0,a.jsx)(d,{children:"Audio Control"})}),(0,a.jsx)(m,{children:(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:"Audio interface coming in Week 2..."})})]});default:return null}})()})]})})]})}},5456:(e,s,t)=>{Promise.resolve().then(t.bind(t,874))}},e=>{var s=s=>e(e.s=s);e.O(0,[88,441,684,358],()=>s(5456)),_N_E=e.O()}]);