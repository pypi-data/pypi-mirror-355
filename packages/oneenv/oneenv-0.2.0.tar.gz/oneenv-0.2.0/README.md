# OneEnv ğŸŒŸã€€[![PyPI Downloads](https://static.pepy.tech/badge/oneenv)](https://pepy.tech/projects/oneenv)

OneEnv is a **revolutionary environment variable management tool** for Python applications that makes configuration management **incredibly simple**. It automatically discovers and consolidates environment variable templates from all your installed packages into a single `.env.example` file - **no manual configuration required**!

## Why OneEnv Makes Your Life Easier ğŸš€

**Before OneEnv:**
- ğŸ˜“ Manual creation of `.env.example` files for each project
- ğŸ˜¤ Hunting through documentation to find required environment variables
- ğŸ˜± Missing critical configuration when integrating new packages
- ğŸ¤¯ Inconsistent environment variable formats across projects

**After OneEnv:**
- âœ¨ **Automatic discovery** of environment variables from all packages
- ğŸ¯ **One command** generates complete `.env.example` files
- ğŸ”„ **Smart merging** of duplicate variables with detailed descriptions
- ğŸ“¦ **Plugin ecosystem** where packages provide their own templates
- ğŸ›¡ï¸ **Type safety** with Pydantic validation

## Revolutionary Features ğŸŒŸ

### ğŸ”Œ **Plugin System with Entry-points**
Packages can automatically provide their environment variable templates - just install and use!

### ğŸ¨ **Smart Duplicate Handling**
When multiple packages define the same variable, OneEnv intelligently merges descriptions while keeping configuration consistent.

### âš¡ **Zero Configuration Setup**
Install a package with OneEnv templates? They're automatically discovered. No imports, no manual registration needed.

### ğŸ”’ **Type-Safe Templates**
Built with Pydantic models for runtime validation and better error messages.

### ğŸ“‹ **Legacy Decorator Support**
Existing `@oneenv` decorators continue to work seamlessly alongside the new plugin system.

## Supported Environments ğŸ–¥ï¸

- **Python**: â‰¥ 3.10
- **Operating Systems**: Windows, macOS, Linux

## Installation ğŸ“¦

You can install OneEnv easily via pip:

```bash
pip install oneenv
```

For development mode, install from the source using:

```bash
pip install -e .
```

## Super Simple Usage ğŸ¯

### Step 1: Install Packages with OneEnv Support
```bash
pip install oneenv
pip install django-oneenv-plugin  # Example: Django templates
pip install fastapi-oneenv-plugin # Example: FastAPI templates
```

### Step 2: Generate Your Environment Template
```bash
oneenv template
```

**That's it!** ğŸ‰ OneEnv automatically discovers all environment variables from your installed packages and creates a complete `.env.example` file.

## Advanced Usage ğŸš€

### ğŸ” See What's Discovered
```bash
oneenv template -d
```
This shows you:
- ğŸ“¦ Which plugins were discovered
- ğŸ”„ Which variables are duplicated across packages
- âš¡ Template generation process

### ğŸ“ Custom Output File
```bash
oneenv template -o my-custom.env
```

### ğŸ”„ Compare Environment Files
```bash
oneenv diff old.env new.env
```

## For Package Developers: Creating OneEnv Plugins ğŸ“¦

### Method 1: Modern Plugin System (Recommended) â­

Create environment templates that are automatically discovered:

**1. Create your template function:**
```python
# mypackage/templates.py
def database_template():
    """Database configuration template"""
    return {
        "DATABASE_URL": {
            "description": "Database connection URL\nExample: postgresql://user:pass@localhost:5432/db",
            "default": "sqlite:///app.db",
            "required": True
        },
        "DB_POOL_SIZE": {
            "description": "Database connection pool size",
            "default": "10",
            "required": False,
            "choices": ["5", "10", "20", "50"]
        }
    }
```

**2. Register in pyproject.toml:**
```toml
[project.entry-points."oneenv.templates"]
database = "mypackage.templates:database_template"
redis = "mypackage.templates:redis_template"
```

**3. That's it!** ğŸ‰ When users install your package, OneEnv automatically discovers your templates.

### Method 2: Legacy Decorator System ğŸ“‹

Still supported for backward compatibility:

```python
from oneenv import oneenv

@oneenv
def my_env_template():
    return {
        "MY_API_KEY": {
            "description": "API key for accessing the service",
            "default": "",
            "required": True
        },
        "MODE": {
            "description": "Application mode setting",
            "default": "development",
            "required": False,
            "choices": ["development", "production"]
        }
    }
```

## Smart Duplicate Variable Handling ğŸ¨

When multiple packages define the same environment variable, OneEnv intelligently merges them:

**Example Output:**
```bash
# Auto-generated by OneEnv

# (Defined in: django-plugin, fastapi-plugin)
# Django database connection URL
# Example: postgresql://user:pass@localhost:5432/django_db
# From fastapi-plugin:
# FastAPI application database connection
# Supports: PostgreSQL, MySQL, SQLite
# Required
DATABASE_URL=sqlite:///django.db

# (Defined in: redis-plugin)
# Redis connection URL
# Example: redis://localhost:6379/0
REDIS_URL=redis://localhost:6379/0
```

**How it works:**
- âœ… **Single entry**: Each variable appears only once
- ğŸ“ **Merged descriptions**: All package descriptions are combined
- âš™ï¸ **First wins**: Configuration (default, required, choices) uses the first package's settings
- ğŸ“‹ **Source tracking**: Shows which packages define each variable

## Template Field Reference ğŸ“š

```python
{
    "VARIABLE_NAME": {
        "description": "Clear description of what this variable does",  # Required
        "default": "default_value",      # Optional: Default value
        "required": True,                # Optional: Whether required (default: False)
        "choices": ["option1", "option2"] # Optional: Valid choices
    }
}
```

## Real-World Examples ğŸŒ

### Django + FastAPI + Redis Project
```bash
pip install oneenv django-oneenv fastapi-oneenv redis-oneenv
oneenv template
```

**Generated .env.example:**
```bash
# Auto-generated by OneEnv

# (Defined in: django-oneenv, fastapi-oneenv)
# Django database connection URL
# From fastapi-oneenv: FastAPI database connection
# Required
DATABASE_URL=sqlite:///django.db

# (Defined in: redis-oneenv)
# Redis connection for caching and sessions
REDIS_URL=redis://localhost:6379/0

# (Defined in: django-oneenv)
# Django secret key for security
# Required
SECRET_KEY=your-secret-key-here
```

### Custom Project Templates
```python
# myproject/env_templates.py
from oneenv import oneenv

@oneenv
def custom_project_config():
    return {
        "PROJECT_NAME": {
            "description": "Name of your awesome project",
            "default": "My Awesome App",
            "required": True
        },
        "ENVIRONMENT": {
            "description": "Deployment environment",
            "default": "development",
            "choices": ["development", "staging", "production"]
        }
    }
```

## Integration with dotenv ğŸ”„

OneEnv wraps [python-dotenv](https://github.com/theskumar/python-dotenv), so you can use all dotenv features directly:

```python
from oneenv import load_dotenv, dotenv_values

# Load environment variables
load_dotenv()

# Get variables as dictionary
config = dotenv_values(".env")
```

## What's New in v0.2.0 ğŸ†•

### ğŸ‰ Revolutionary Plugin System
- **Entry-points Integration**: Packages automatically provide environment variable templates
- **Smart Duplicate Handling**: Intelligent merging of variables from multiple packages
- **Pydantic Type Safety**: Runtime validation with clear error messages
- **Zero Configuration**: Automatic discovery - no imports or manual registration needed

### ğŸ”„ Migration from v0.1.x
Your existing `@oneenv` decorators continue to work without any changes! The new plugin system runs alongside your current setup.

**For package developers:** Consider adding entry-points to your `pyproject.toml` for automatic discovery:
```toml
[project.entry-points."oneenv.templates"]
myfeature = "mypackage.templates:my_template_function"
```

## Why OneEnv is Game-Changing ğŸ¯

- **ğŸš« No more hunting**: Environment variables are automatically documented
- **âš¡ Zero setup time**: Install packages, run one command, done
- **ğŸ”„ Stay synchronized**: Environment configs update automatically with package updates
- **ğŸ‘¥ Team harmony**: Everyone gets the same environment setup
- **ğŸ“¦ Ecosystem growth**: Package authors can provide better configuration experiences

## Running Tests ğŸ§ª

```bash
pytest tests
```

## Contributing ğŸ¤

We welcome contributions! Please feel free to submit a Pull Request or open an issue on GitHub.

## License âš–ï¸

This project is released under the MIT License.