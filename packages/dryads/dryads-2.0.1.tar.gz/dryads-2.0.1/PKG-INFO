Metadata-Version: 2.3
Name: dryads
Version: 2.0.1
Summary: Simple CLI building tool and script management tool.
Author: zweix123
Author-email: 1979803044@qq.com
Requires-Python: >=3.8,<4.0
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Description-Content-Type: text/markdown

# Dryads

Simple CLI building tool and script management tool.

- å¯¹æ ‡ï¼š
  - Simple CLI building tools: argparse, click and typer
  - Script management tool: [Just](https://github.com/casey/just)

## å‘å¿ƒ

åœ¨å›¾å½¢åŒ–ï¼ˆGUIï¼‰è½¯ä»¶å‡ºçŽ°ä¹‹å‰ï¼Œè®¡ç®—æœºæ“ä½œå‘˜ä½¿ç”¨çš„æ˜¯å‘½ä»¤è¡Œï¼ˆCLIï¼‰è½¯ä»¶ã€‚ä¸¤ç§è½¯ä»¶æœ¬è´¨æ˜¯å°†äººçš„æŒ‡ä»¤äº¤ç»™è®¡ç®—æœºã€‚

å­¦æœ¯çš„è¯´ï¼Œåœ¨ CLI ä¸­ï¼Œæœ‰ argument å‚æ•°ï¼Œä¸å¸¦å‰ç¼€ï¼Œæ˜¯å­—ç¬¦ä¸²ï¼›flag æ ‡å¿—ï¼Œé€šå¸¸ä»¥`-`å¼€å¤´ï¼Œé€šå¸¸æ˜¯å¯é€‰çš„ï¼Œç›¸å½“äºŽ bool å€¼ï¼›options é€‰é¡¹ï¼Œé€šå¸¸ä»¥`-`æˆ–è€…`--`å¼€å¤´ï¼Œé€šå¸¸åŽæŽ¥å‚æ•°ã€‚æ³¨æ„`git add`ä¸­çš„`add`å¹¶ä¸å±žäºŽæ­¤ä¸‰è€…çš„ä»»ä½•ä¸€ä¸ªï¼Œè€Œæ˜¯å‘½ä»¤æœ¬èº«ã€‚

å½¢è±¡çš„è¯´ï¼Œå‘½ä»¤ã€å‚æ•°ã€æ ‡å¿—å’Œé€‰é¡¹æ˜¯äººå’Œè®¡ç®—æœºäº¤æµçš„è¯­è¨€ã€‚è€Œå›´ç»•æŸä¸€ä¸ªäº‹ç‰©çš„ä¸€ç³»åˆ—ä¿®é¥°è¯ä¸­ï¼Œå°†å½’çº³æ±‡æ€»å¹¶ä¾æ¬¡è¿žæŽ¥ï¼Œå¯å½¢æˆæ ‘å½¢ç»“æž„ï¼Œå¾ˆå¤šå‘½ä»¤è¡Œå·¥å…·çš„é€‰é¡¹éƒ½æ˜¯ã€‚

ä¸¾ä¸ª ðŸŒ°ï¼Œ[ç½‘æ˜“çš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿ](https://github.com/opencurve/curve)ä¸‹æœ‰å¯¹é›†ç¾¤çš„è¿ç»´å·¥å…·[curve-tool](https://github.com/opencurve/curve/tree/master/tools-v2)

![](./assets/curve_help.png)  
æœ‰å­å‘½ä»¤ï¼Œåˆ†åˆ«æ˜¯`bs`ï¼ˆç®¡ç†å—å­˜å‚¨é›†ç¾¤ï¼‰ã€`completion`()ã€`fs`ï¼ˆç®¡ç†æ–‡ä»¶å­˜å‚¨é›†ç¾¤ï¼‰ã€`upgrade`ï¼ˆå‡çº§ï¼‰ã€‚

ä½¿ç”¨ä¸€ä¸ªå­å‘½ä»¤ç»§ç»­çœ‹  
![](./assets/curve_bs_help.png)  
è¿˜æœ‰å­å‘½ä»¤ï¼Œå¯ä»¥ç†è§£ä¸ºé’ˆå¯¹å—å­˜å‚¨é›†ç¾¤çš„å„ç§æ“ä½œï¼Œæ¯”å¦‚`check`ï¼ˆæ£€æµ‹ï¼‰ã€`create`ï¼ˆåˆ›å»ºèµ„æºï¼‰ã€`delete`ï¼ˆåˆ é™¤èµ„æºï¼‰ã€`list`ï¼ˆç½—åˆ—èµ„æºï¼‰ç­‰ç­‰ã€‚

ç»§ç»­ä½¿ç”¨ä¸€ä¸ªå­å‘½ä»¤ç»§ç»­çœ‹
![](./assets/curve_bs_check_help.png)  
è¿˜æœ‰å­å‘½ä»¤ï¼Œå¯¹äºŽâ€œæ£€æµ‹â€è¿™ä¸ªåŠ¨ä½œï¼Œè¿˜èƒ½ç»§ç»­â€œä¿®é¥°â€ï¼Œåˆ°åº•æ£€æµ‹ä»€ä¹ˆâ€œäº‹ç‰©â€

ç»§ç»­ä½¿ç”¨ä¸€ä¸ªå­å‘½ä»¤ç»§ç»­çœ‹
![](./assets/curve_bs_check_chunkserver_help.png)  
è‡³æ­¤ç¡®å®žæ²¡æœ‰äº†ï¼Œå¼€å§‹æ·»åŠ  flag äº†

å¯ä»¥æƒ³è±¡ï¼Œå°†è¿™é‡Œæ‰€æœ‰çš„å­å‘½ä»¤å–å‡ºæ¥ï¼Œå¹¶é€šè¿‡å‰åŽå…³ç³»ä½œä¸º Parent ç»“ç‚¹å’Œ Child ç»“ç‚¹ï¼Œå¯ä»¥å½¢æˆæ ‘å½¢ç»“æž„ã€‚

å†ä¸¾ä¸ª ðŸŒ°ï¼Œåœ¨å®Œæˆ[CMU 15445 Lab](https://15445.courses.cs.cmu.edu/)è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è¾ƒå¤šå‘½ä»¤ï¼Œæ¯”å¦‚æµ‹è¯•ã€æ ¼å¼åŒ–ã€æ‰“åŒ…ç­‰ç­‰ã€‚è€Œæ¯ä¸ªåŠ¨ä½œè¿˜èƒ½ç»†åˆ†ï¼Œæ¯”å¦‚ Lab åˆ†æˆå¤šä¸ª Projectï¼Œæ¯ä¸ª Project åˆåˆ†æˆå¤šä¸ª Taskã€‚äºŽæ˜¯å°±å‡ºçŽ°äº†â€œæµ‹è¯• Project1 Task1 ç›¸å…³ä»£ç â€è¿™æ ·çš„å‘½ä»¤ã€‚åŒç†ï¼Œæ ¼å¼åŒ–å’Œæ‰“åŒ…æ“ä½œä¹Ÿç±»ä¼¼ã€‚æ‰€ä»¥å¯å½¢æˆå¦‚ä¸‹æ ‘å½¢ç»“æž„ï¼ˆä»¥ Json è¡¨ç¤ºï¼‰

```json
{
    "test": {
        "p1": {
            "t1": ...,
            "t2": ...,
            ...
        },
        "p2": ...,
        ...
    },
    "format": ...,
    "submit": ...,
}
```

æ•…æœ¬é¡¹ç›®çš„ä½¿ç”¨åœºæ™¯å‘¼ä¹‹æ¬²å‡º

- Simple CLI building tools: å¦‚æžœå‘½ä»¤è¡Œå·¥å…·å¯ä»¥æè¿°ä¸ºåµŒå¥—çš„å­å‘½ä»¤ï¼Œåˆ™è¯¥æ¡†æž¶å¯ä»¥å¾ˆç®€å•çš„æž„å»ºã€‚
- Script management tool: å¦‚æžœå›´ç»•æŸä¸ªé¡¹ç›®æˆ–è€…åœ¨å·¥ä½œæµä¸­æœ‰ä¸€ç³»åˆ—çš„å‘½ä»¤ï¼Œå¯ä»¥ç”¨è¯¥æ¡†æž¶ç®¡ç†ä½¿ä¹‹ç»´æŠ¤åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚åŒæ—¶å¤§é‡çš„å‘½ä»¤å‡ ä¹Žæ— æ³•è®°å¿†ï¼ˆæ¯”å¦‚åœ¨ 15445 ä¸­ä½¿ç”¨çš„å‘½ä»¤ï¼‰ï¼Œé€šè¿‡å­å‘½ä»¤çš„æ–¹å¼ä½¿è®°å¿†å®ƒä»¬ç§°ä¸ºå¯èƒ½ï¼ˆå­å‘½ä»¤å¯¹åº”ä¸€ä¸ªè„šæœ¬ï¼‰ã€‚åŒæ—¶ï¼Œæ–‡ä»¶ä¸»ä½“æ˜¯ä¸€ä¸ª Python æ–‡ä»¶ï¼Œå‘½ä»¤ä½œä¸ºå­—ç¬¦ä¸²åµŒå…¥å…¶ä¸­ï¼ŒåŒæ ·æ˜¯è„šæœ¬è¯­è¨€ï¼ŒPython æœ‰è¾ƒäºŽ Bash æˆ–è€… Powershell å¼ºçš„å¤šçš„è¡¨æ„èƒ½åŠ›å’Œè·¨å¹³å°æ€§ã€‚

è¯¥å·¥å…·ä»¥åµŒå…¥æˆ‘çš„å·¥ä½œæµä¸­å¹¶æžå¤§çš„æé«˜æˆ‘çš„æ•ˆçŽ‡ã€‚

## Install

- é€šè¿‡ PyPIï¼š[PyPI](https://pypi.org/project/dryads/)

  ```bash
  pip install dryads
  ```

  åŒæ—¶ä¼šä¸‹è½½å‘½ä»¤`ds`ï¼Œå®ƒä¼šåœ¨å½“å‰è·¯å¾„é€’å½’å‘ä¸Šå¯»æ‰¾`dryadsfile`æ–‡ä»¶å¹¶ä½¿ç”¨ Python è§£é‡Šå™¨è¿è¡Œå®ƒã€‚æˆ‘ä»¬ä¹Ÿå»ºè®®æ¯ä¸ªé¡¹ç›®ä¸‹éƒ½æœ‰ä¸€ä¸ª`dryadsfile`ç”¨æ¥ç®¡ç†ç»´æŠ¤è¯¥é¡¹ç›®éœ€è¦å‘½ä»¤ï¼ŒåŽŸå› åœ¨[Just Further Ramblings](https://github.com/casey/just/tree/master?tab=readme-ov-file#further-ramblings)ã€‚

## Use

- å‘½ä»¤`ds`ï¼Œå¦‚ä¸Šï¼Œå®ƒä¼šåœ¨å½“å‰è·¯å¾„é€’å½’å‘ä¸Šå¯»æ‰¾`dryadsfile`æ–‡ä»¶å¹¶ä½¿ç”¨ Python è§£é‡Šå™¨è¿è¡Œå®ƒã€‚
  - ç¼–è¯‘å™¨é€šå¸¸é€šè¿‡æ–‡ä»¶åŽç¼€åè¯†åˆ«æ–‡ä»¶ç±»åž‹ï¼Œä½†æ˜¯`dryadsfile`å¹¶æ²¡æœ‰æ–‡ä»¶åŽç¼€ï¼Œåœ¨ VSCode ä¸­ï¼Œå¯ä»¥åœ¨`.vscode/settings.json`ä¸­æ·»åŠ ä¸‹é¢å†…å®¹è§£å†³ã€‚
    ```json
    "files.associations": {
        "dryadsfile": "python"
    },
    ```
- å¦‚æžœæ˜¯åœ¨ Linux ç³»ç»Ÿï¼Œé€šè¿‡åœ¨è„šæœ¬å‰æ·»åŠ  shebang

  ```python
  #!/usr/bin/env python3
  # -*- coding: utf-8 -*-
  ```

  åˆ™å¯ä»¥é€šè¿‡`./script.py`è¿™ç§å¾ˆæŽ¥è¿‘å‘½ä»¤çš„å½¢å¼ä½¿ç”¨

ä½¿ç”¨å­—ç¬¦ä¸²è¡¨è¾¾è„šæœ¬å†…å®¹ï¼Œè€Œ Python ä¸­â€œä¸‡ç‰©çš†å¯¹è±¡â€ï¼Œå¯ä»¥å°†å‡½æ•°æœ¬èº«ä½œä¸ºå€¼ä¼ é€’ã€‚ä½¿ç”¨`dict`æ•°æ®ç±»åž‹å³å¯æè¿°å‡ºæ ‘å½¢ç»“æž„ï¼Œå°†è¯¥`dict`äº¤ç»™æ¡†æž¶ï¼Œå­å‘½ä»¤çš„è§£æžå’Œæ‰§è¡Œäº¤ç»™æ¡†æž¶å³å¯ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªç»å…¸çš„ä¾‹å­ã€‚

```python
# test/classic_example.py
from dryads import Dryads, DryadsContainer, DryadsFlag, run_shell_cmd

def create_python():
    run_shell_cmd(f"poetry new {DryadsContainer.DryadsArg}")

def create_rust():
    run_shell_cmd(f"cargo new {DryadsContainer.DryadsArg}")

CMDS = {
    "echo": {
        "English": "echo Hello World",
        "Chinese": "echo æˆ‘å¯ä»¥åžä¸‹çŽ»ç’ƒè€Œä¸å—åˆ°ä¼¤å®³",
        "Math": ["echo 42", "echo 3.14"],
    },
    "work": {
        DryadsFlag.PrefixCmd: ["cd Project"],
        "build": "cd build && make -j`nproc`",
        "run": "./build/bin/work",
    },
    "create": {
        "python": [
            DryadsFlag.Anchoring,
            DryadsFlag.AcceptArg,
            create_python,
        ],
        "rust": [
            DryadsFlag.Anchoring,
            DryadsFlag.AcceptArg,
            create_rust,
        ],
    },
    ("-d", "--dryads"): "echo Hello Dryads",
}

Dryads(CMDS)
```

ç›´æŽ¥æ‰§è¡Œä¸Šæ–‡ä»¶è¾“å‡ºå¦‚ä¸‹  
![](./assets/classic_example.png)

ç›¸å½“äºŽ  
![](./assets/classic_example_help.png)

å…¶ä¸­å­å‘½ä»¤`env`å’Œ`-h`/`--help`æ˜¯é»˜è®¤ç”Ÿæˆçš„

å¯¹äºŽå„çº§å­å‘½ä»¤ï¼Œä¹Ÿèƒ½ä½¿ç”¨`-h`ï¼ˆæˆ–è€…`--help`ï¼‰é€‰é¡¹
![](./assets/classic_example_echo_help.png)

ä¸‹é¢èŠèŠè¯­æ³•

- ä»¥åµŒå¥—çš„`dict`æ•°æ®ç»“æž„æè¿°æ ‘å½¢ç»“æž„
- `dict`çš„é”®åªèƒ½æ˜¯`str`æˆ–è€…`tuple[str]`æˆ–è€…`DryadsFlag`ï¼ˆè¿™æ˜¯ä»€ä¹ˆåŽé¢å†èŠï¼‰æ¥æè¿°å­å‘½ä»¤
- å¶å­èŠ‚ç‚¹ä»¥`str`/`Callable`/`list[str | Callable | DryadsFlag]`ç±»åž‹è¡¨ç¤ºå…·ä½“çš„è¦æ‰§è¡Œçš„è„šæœ¬å†…å®¹ã€‚

  - æ¯ä¸ª`str`ç±»åž‹å­—é¢é‡ä½œä¸ºä¸€ä¸ª Shell è„šæœ¬ä¸€èµ·äº¤ç»™ Shell æ‰§è¡Œï¼Œå³ä¸€ä¸ªå­—ç¬¦ä¸²å¯ä»¥æ˜¯å¤šè¡Œçš„ï¼Œå®ƒä»¬æ˜¯è¿žç»­çš„ã€‚

    - å¦‚æžœåœ¨`list[str]`ä¸­æœ‰`cd`å‘½ä»¤ï¼Œåˆ—è¡¨ä¸­çš„å…¶ä»–å­—ç¬¦ä¸²ä¸­çš„å‘½ä»¤ä¸ä¼šè¢«å½±å“ã€‚

- æ‰§è¡Œï¼šä¸€ä¸ªå‘½ä»¤çš„æ‰€æœ‰å­å‘½ä»¤ç›¸å½“äºŽä»Žæ ¹åˆ°å¶å­çš„è·¯å¾„

  - å¶å­èŠ‚ç‚¹ï¼š  
    ![](./assets/classic_example_echo_chinese.png)

  - ä¸­é—´èŠ‚ç‚¹ï¼šæ‰§è¡Œè¯¥èŠ‚ç‚¹å­æ ‘ä¸­çš„æ‰€æœ‰å¶å­èŠ‚ç‚¹  
    ![](./assets/classic_example_echo.png)

- æ ‡è®°`DryadsFlag`ï¼Œå½“å¸Œæœ›æ”¹å˜æŸäº›é»˜è®¤çš„è¡Œä¸ºæ—¶ï¼Œä»¥æ ‡è®°çš„æ–¹å¼å®žçŽ°ã€‚å…¶æœ¬èº«æ˜¯æžšä¸¾é‡ï¼Œä½œä¸ºé”®æˆ–è€…å¶å­æ‰§è¡Œä¿®æ”¹æŸç§è¡Œä¸ºã€‚

  - `DryadsFlag.Anchoring`: ä½œä¸ºå¶å­çš„å€¼, è¡¨ç¤ºè¯¥å¶å­ä¸­çš„å‘½ä»¤éƒ½æ˜¯ä»¥æ‰§è¡Œè„šæœ¬çš„è·¯å¾„å¼€å§‹, é»˜è®¤ä»Žè„šæœ¬æ‰€åœ¨çš„è·¯å¾„å¼€å§‹, ä¾‹å­åœ¨[Anchoring](./examples/flag_anchring.py)
  - `DryadsFlag.InVisible`: ä½œä¸ºå¶å­çš„å€¼, è¡¨ç¤ºæ‰§è¡Œçš„è„šæœ¬æ˜¯å¦æ‰“å°, é»˜è®¤æ‰“å°, ä½¿ç”¨è¯¥æ ‡å¿—è¡¨ç¤ºä¸æ‰“å°, ä¾‹å­åœ¨[InVisible](./examples/flag_invisiable.py)
  - `DryadsFlag.IgnoreErr`: ä½œä¸ºå¶å­çš„å€¼, è¡¨ç¤ºå‘½ä»¤æ‰§è¡Œå‡ºé”™åŽæ˜¯å¦åœæ­¢, é»˜è®¤åœæ­¢, ä½¿ç”¨è¯¥æ ‡å¿—è¡¨ç¤ºä¸åœæ­¢, ä¾‹å­åœ¨[IgnoreErr](./examples/flag_ignore_err.py)
  - `DryadsFlag.PrefixCmd`: ä½œä¸ºæŸä¸ªèŠ‚ç‚¹çš„é”®, å…¶å€¼å¯¹åº”çš„è„šæœ¬ä¸ºå…¶æ‰€æœ‰å…„å¼ŸèŠ‚ç‚¹çš„å­æ ‘ä¸­æ‰€æœ‰è„šæœ¬çš„å‰ç½®è„šæœ¬, ä¾‹å­åœ¨[PrefixCmd](./examples/flag_prefix_cmd.py)
    - è¯¥æ ‡è®°åªèƒ½ç”¨äºŽ`dict`ä¸èƒ½ç”¨äºŽ`list`ï¼Œä½†å¾€å¾€æ˜¯å¯¹å¶å­èŠ‚ç‚¹`list`ä¸­çš„ä¸€ç³»åˆ—å‘½ä»¤è®¾ç½®å‰ç½®è„šæœ¬ï¼Œå¯é€šè¿‡å†å¥—ä¸€å±‚ dict è§£å†³ã€‚

- å‚æ•°: å°†æ‰€æœ‰çš„å­å‘½ä»¤åŒ¹é…ä¹‹åŽçš„å‘½ä»¤è¡Œå‚æ•°, å³è§†ä¸º dryads çš„å‚æ•°, å¯ä»¥é€šè¿‡`dryads.argv`èŽ·å–, ä¾‹å­åœ¨[MultiLineCmd](./examples/accept_arg_func.py)

## ç”¨æˆ·

- [BusTub lab test script](https://github.com/zweix123/bustub_2023spring_backup/blob/master/script.py#L146): [ä»‹ç»](https://github.com/zweix123/CS-notes/blob/master/README.md#CMU15445)
- [Note Tool](https://github.com/zweix123/CS-notes/blob/master/dryadsfile#L292)

