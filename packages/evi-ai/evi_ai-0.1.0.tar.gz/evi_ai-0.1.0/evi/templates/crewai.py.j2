# CrewAI Agent System
# Generated by evi - Multi-Agent Framework Generator

from crewai import Agent, Task, Crew
from langchain.tools import DuckDuckGoSearchRun

# Initialize tools
search_tool = DuckDuckGoSearchRun()

# Define the agents
agents = [
{% for agent in agents %}
    Agent(
        name="{{ agent.name }}",
        role="{{ agent.role }}",
        goal="{{ agent.goal }}",
        backstory="{{ agent.backstory }}"{% if agent.tools %},
        tools=[{{ agent.tools|join(', ') }}]{% endif %}{% if agent.verbose is defined %},
        verbose={{ agent.verbose|lower }}{% endif %}
    ){% if not loop.last %},{% endif %}
{% endfor %}
]

# Define the tasks
tasks = [
{% for task in tasks %}
    Task(
        description="{{ task.description }}",
        agent=next(a for a in agents if a.name == "{{ task.agent }}"){% if task.expected_output %},
        expected_output="{{ task.expected_output }}"{% endif %}{% if task.dependencies %},
        dependencies=[{% for dep in task.dependencies %}
            next(t for t in tasks if t.description.startswith("{{ dep }}")){% if not loop.last %},{% endif %}
        {% endfor %}]{% endif %}
    ){% if not loop.last %},{% endif %}
{% endfor %}
]

# Create the crew
crew = Crew(
    agents=agents,
    tasks=tasks,
    verbose=True,
    process="{{ workflow|default("sequential") }}"
)

# Run the crew
if __name__ == "__main__":
    result = crew.run()
    print(f"Crew Result: {result}")
